var $parcel$global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},$parcel$modules={},$parcel$inits={},parcelRequire=$parcel$global.parcelRequire94c2;null==parcelRequire&&(parcelRequire=function(e){if(e in $parcel$modules)return $parcel$modules[e].exports;if(e in $parcel$inits){var t=$parcel$inits[e];delete $parcel$inits[e];var i={id:e,exports:{}};return $parcel$modules[e]=i,t.call(i.exports,i,i.exports),i.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r},parcelRequire.register=function(e,t){$parcel$inits[e]=t},$parcel$global.parcelRequire94c2=parcelRequire),parcelRequire.register("45Ip7",(function(e,t){class i{static#e=$objc("UIApplication").$sharedApplication();static#t=$objc("UINotificationFeedbackGenerator").$new();static feedbackSuccess(){i.#t.$notificationOccurred(0)}static feedbackError(){i.#t.$notificationOccurred(2)}static align={left:0,right:1,top:2,bottom:3};static textColor=$color("primaryText");static linkColor=$color("systemLink");static primaryViewBackgroundColor=$color("primarySurface");static scrollViewBackgroundColor=$color("insetGroupedBackground");static scrollViewList=["list","matrix"];static isLargeScreen=$device.isIpad||$device.isIpadPro;static get windowSize(){return $objc("UIWindow").$keyWindow().jsValue().size}static NavigationBarNormalHeight=$objc("UINavigationController").invoke("alloc.init").$navigationBar().jsValue().frame.height;static NavigationBarLargeTitleHeight=$objc("UITabBarController").invoke("alloc.init").$tabBar().jsValue().frame.height+i.NavigationBarNormalHeight;static get isSplitScreenMode(){return i.isLargeScreen&&$device.info.screen.width!==i.windowSize.width}static get topSafeAreaInsets(){return i.#e?.$keyWindow()?.$safeAreaInsets()?.top??0}static get bottomSafeAreaInsets(){return i.#e?.$keyWindow()?.$safeAreaInsets()?.bottom??0}static get statusBarOrientation(){return i.#e.$statusBarOrientation()}static get consoleBarHeight(){if($app.isDebugging){let e=i.#e.$statusBarFrame().height+26;return $device.isIphoneX&&(e+=30),e}return 0}static get isHorizontal(){return 3===i.statusBarOrientation||4===i.statusBarOrientation}static loading(){const e=$ui.create(i.blurBox({cornerRadius:15},[{type:"spinner",props:{loading:!0,style:0},layout:(e,t)=>{e.size.equalTo(t.prev),e.center.equalTo(t.super)}}]));return{start:()=>{$ui.controller.view.insertAtIndex(e,0),e.layout(((e,t)=>{e.center.equalTo(t.super);const r=Math.min(.6*Math.min(i.windowSize.width,i.windowSize.height),260);e.size.equalTo($size(r,r))})),e.moveToFront()},end:()=>{e.remove()}}}static defaultBackgroundColor(e){return i.scrollViewList.indexOf(e)>-1?i.scrollViewBackgroundColor:i.primaryViewBackgroundColor}static separatorLine(e={},t=i.align.bottom){return{type:"canvas",props:e,layout:(e,r)=>{void 0===r.prev?e.top.equalTo(r.super):t===i.align.bottom?e.top.equalTo(r.prev.bottom):e.top.equalTo(r.prev.top),e.height.equalTo(1/$device.info.screen.scale),e.left.right.inset(0)},events:{draw:(t,i)=>{i.strokeColor=e.bgcolor??$color("separatorColor"),i.setLineWidth(1),i.moveToPoint(0,0),i.addLineToPoint(t.frame.width,0),i.strokePath()}}}}static blurBox(e={},t=[],i=$layout.fill){return{type:"blur",props:Object.assign({style:$blurStyle.thinMaterial},e),views:t,layout:i}}static getContentSize(e,t="A",r=i.windowSize.width,a){const s={text:t,width:r,font:e};return void 0!==a&&(s.lineSpacing=a),$text.sizeThatFits(s)}static getSymbolSize(e,t){const i=(e="string"==typeof e?$image(e):e).size.width/e.size.height;return e.size.width>e.size.height?$size(t,t/i):$size(t*i,t)}static push({views:e,statusBarStyle:t=0,title:i="",navButtons:r=[{title:""}],bgcolor:a=e[0]?.props?.bgcolor??"primarySurface",titleView:s,disappeared:o}={}){const n={statusBarStyle:t,navButtons:r,title:i,bgcolor:"string"==typeof a?$color(a):a};s&&(n.titleView=s),$ui.push({props:n,events:{disappeared:()=>{void 0!==o&&o()}},views:[{type:"view",views:e,layout:(e,t)=>{e.top.equalTo(t.super.safeArea),e.bottom.equalTo(t.super),e.left.right.equalTo(t.super.safeArea)}}]})}}e.exports={UIKit:i}})),parcelRequire.register("aXWmO",(function(e,t){var i=parcelRequire("6Xrbz").ValidationError,r=parcelRequire("45Ip7").UIKit,a=parcelRequire("12xzj").NavigationView,s=parcelRequire("dcStC").NavigationBar;class o extends Error{constructor(){super("Please call setView(view) first."),this.name="SheetViewUndefinedError"}}class n extends i{constructor(e,t){super(e,t),this.name="SheetViewTypeError"}}class l{#i=()=>{};#r=()=>{};style=l.UIModalPresentationStyle.PageSheet;#a=!1;#s;static UIModalPresentationStyle={Automatic:-2,FullScreen:0,PageSheet:1,FormSheet:2,CurrentContext:3,Custom:4,OverFullScreen:5,OverCurrentContext:6,Popover:7,BlurOverFullScreen:8};navigationView;init(){this.initNavBar();const{width:e,height:t}=$device.info.screen,i=$objc("UIView").invoke("initWithFrame",$rect(0,0,e,t)),a=$objc("UIViewController").invoke("alloc.init"),s=a.$view();return s.$setBackgroundColor(r.primaryViewBackgroundColor),s.$addSubview(i),a.$setModalPresentationStyle(this.style),a.$setModalInPresentation(this.#a),this.#i=()=>{s.jsValue().add(this.navigationView?.getPage().definition??this.view),$ui.vc.ocValue().invoke("presentViewController:animated:completion:",a,!0,void 0)},this.#r=()=>a.invoke("dismissViewControllerAnimated:completion:",!0,void 0),this}initNavBar(){if(!this.#s)return;const{title:e="",popButton:t={title:$l10n("CLOSE")},rightButtons:i=[]}=this.#s;if(void 0===this.view)throw new o;this.navigationView=new a;const r=this.navigationView.navigationBar;r.setLargeTitleDisplayMode(s.largeTitleDisplayModeNever),r.navigationBarLargeTitleHeight-=r.navigationBarNormalHeight,r.navigationBarNormalHeight=s.pageSheetNavigationBarHeight,r.navigationBarLargeTitleHeight+=r.navigationBarNormalHeight,this.style===l.UIModalPresentationStyle.FullScreen||this.style===l.UIModalPresentationStyle.OverFullScreen||this.style===l.UIModalPresentationStyle.BlurOverFullScreen?r.setTopSafeArea():r.removeTopSafeArea(),t.events=Object.assign({tapped:()=>{this.dismiss(),"function"==typeof t.tapped&&t.tapped()}},t.events??{}),this.navigationView.navigationBarItems.addLeftButton(t).setRightButtons(i),this.navigationView.setView(this.view).navigationBarTitle(e),this.view.props?.bgcolor&&this.navigationView?.getPage().setProp("bgcolor",this.view.props?.bgcolor)}preventDismiss(){return this.#a=!0,this}setStyle(e){return this.style=e,this}setView(e={}){if("object"!=typeof e)throw new n("view","object");return this.view=e,this}addNavBar(e){return this.#s=e,this}present(){this.#i()}dismiss(){this.#r()}}e.exports={Sheet:l}})),parcelRequire.register("6Xrbz",(function(e,t){class i extends Error{constructor(e,t){super(`The type of the parameter '${e}' must be '${t}'`),this.name="ValidationError"}}e.exports={ValidationError:i}})),parcelRequire.register("12xzj",(function(e,t){var i=parcelRequire("fYz8N").Controller,r=parcelRequire("liCrE"),a=r.View,s=r.PageView,o=parcelRequire("6Xrbz").ValidationError,n=parcelRequire("cgaQ6").Kernel,l=parcelRequire("45Ip7").UIKit,h=parcelRequire("dcStC"),c=h.NavigationBar,d=h.NavigationBarController,u=parcelRequire("gAYmG").NavigationBarItems;class p extends o{constructor(e,t){super(e,t),this.name="NavigationViewTypeError"}}e.exports={NavigationView:class extends i{page;navigationController=new d;navigationBar=new c;navigationBarItems=new u;constructor(){super(),this.navigationBar.navigationBarItems=this.navigationBarItems,this.navigationController.navigationBar=this.navigationBar}navigationBarTitle(e){return this.navigationBar.setTitle(e),this}setView(e){if("object"!=typeof e)throw new p("view","object");return this.view=a.create(e),this}#o(){if(!(this.view instanceof a))throw new p("view","View");const e=this.view.scrollableView,t=$app.isDebugging||n.isTaio?0:l.topSafeAreaInsets,i=this.navigationBar.largeTitleDisplayMode===c.largeTitleDisplayModeNever?this.navigationBar.navigationBarNormalHeight:this.navigationBar.navigationBarLargeTitleHeight;let r=this.navigationBar.contentViewHeightOffset+i;if(this.navigationBarItems.titleView&&(r+=this.navigationBarItems.titleView.topOffset,r+=this.navigationBarItems.titleView.height,r+=this.navigationBarItems.titleView.bottomOffset),!this.view.scrollable||!1===e.props.associateWithNavigationBar)return void(this.view.layout=(e,i)=>{e.left.right.equalTo(i.super.safeArea),e.bottom.equalTo(i.super);let a=r-this.navigationBar.contentViewHeightOffset;l.isHorizontal&&!l.isLargeScreen||!this.navigationBar.topSafeArea||(a+=t),e.top.equalTo(a)});e.props.stickyHeader&&(r-=i,r+=this.navigationBar.largeTitleFontHeight),e.props.header?e.props.header={type:"view",props:{height:r+(e.props.header?.props?.height??0)},views:[{type:"view",props:{clipsToBounds:!0},views:[e.props.header],layout:(e,t)=>{e.top.equalTo(r),e.bottom.width.equalTo(t.super)}}]}:e.props.header={props:{height:r}},e.props.footer=Object.assign({props:{}},e.props.footer??{}),e.props.footer.props.height=(this.navigationBarItems.fixedFooterView?.height??0)+(e.props.footer.props?.height??0);const s=this.navigationBarItems.isPinTitleView?this.navigationBarItems.titleView.height+this.navigationBarItems.titleView.bottomOffset+this.navigationBar.contentViewHeightOffset:0;if(e.props.indicatorInsets){const t=e.props.indicatorInsets;e.props.indicatorInsets=$insets(t.top+this.navigationBar.navigationBarNormalHeight+s,t.left,t.bottom+(this.navigationBarItems.fixedFooterView?.height??0),t.right)}else e.props.indicatorInsets=$insets(this.navigationBar.navigationBarNormalHeight+s,0,this.navigationBarItems.fixedFooterView?.height??0,0);e.layout=(t,i)=>{e.props.stickyHeader?t.top.equalTo(i.super.safeArea).offset(this.navigationBar.navigationBarNormalHeight):t.top.equalTo(i.super),t.left.right.equalTo(i.super.safeArea),t.bottom.equalTo(i.super)},e.assignEvent("didScroll",(i=>{let r=i.contentOffset.y;l.isHorizontal&&!l.isLargeScreen||!this.navigationBar.topSafeArea||e.props.stickyHeader||(r+=t),this.navigationController.didScroll(r)})).assignEvent("didEndDragging",((i,r)=>{let a=i.contentOffset.y,s=0;l.isHorizontal&&!l.isLargeScreen||!this.navigationBar.topSafeArea||e.props.stickyHeader||(a+=t,s=t),this.navigationController.didEndDragging(a,r,((...e)=>i.scrollToOffset(...e)),s)})).assignEvent("didEndDecelerating",((...t)=>{t[0].tracking||e.events?.didEndDragging(...t)}))}#n(){if(this.navigationBar.prefersLargeTitles){this.#o();let e={};if(this.navigationBarItems.titleView){const t=this.navigationBar.largeTitleDisplayMode===c.largeTitleDisplayModeNever?1:0;e=a.create({views:[this.navigationBar.backgroundColor?{type:"view",props:{alpha:t,bgcolor:this.navigationBar.backgroundColor,id:this.navigationBar.id+"-title-view-background"},layout:$layout.fill}:l.blurBox({alpha:t,id:this.navigationBar.id+"-title-view-background"}),l.separatorLine({id:this.navigationBar.id+"-title-view-underline",alpha:t}),this.navigationBarItems.titleView.definition],layout:(e,t)=>{e.top.equalTo(t.prev.bottom),e.width.equalTo(t.super),e.height.equalTo(this.navigationBarItems.titleView.topOffset+this.navigationBarItems.titleView.height+this.navigationBarItems.titleView.bottomOffset)}})}this.page=s.createFromViews([this.view,this.navigationBar.getLargeTitleView(),e,this.navigationBar.getNavigationBarView(),this.navigationBarItems.fixedFooterView?.definition??{}])}else this.page=s.createFromViews([this.view]);this.view.props?.bgcolor?this.page.setProp("bgcolor",this.view.props.bgcolor):this.page.setProp("bgcolor",l.defaultBackgroundColor(this.view.type))}getPage(){return this.page||this.#n(),this.page}}}})),parcelRequire.register("fYz8N",(function(e,t){e.exports={Controller:class{events={};setEvents(e){return Object.keys(e).forEach((t=>this.setEvent(t,e[t]))),this}setEvent(e,t){return this.events[e]=t,this}callEvent(e,...t){"function"==typeof this.events[e]&&this.events[e](...t)}}}})),parcelRequire.register("liCrE",(function(e,t){var i=parcelRequire("45Ip7").UIKit;class r{id=$text.uuid;type;props;views;events;layout;#l=void 0;#h=null;constructor({type:e="view",props:t={},views:i=[],events:r={},layout:a=$layout.fill}={}){this.type=e,this.props=t,this.views=i,this.events=r,this.layout=a,this.props.id?this.id=this.props.id:this.props.id=this.id}static create(e){return new this(e)}static createFromViews(e){return new this({views:e})}get scrollableView(){return this.scrollable?this.#h:null}set scrollableView(e){this.#h=e}get scrollable(){if(void 0===this.#l)if(this.#l=!1,i.scrollViewList.indexOf(this.type)>-1)this.scrollableView=this,this.#l=!0;else if(this.views.length>0){const e=t=>{if(!this.#l&&t?.length>0)for(let a=0;a<t.length;a++){if(i.scrollViewList.indexOf(t[a].type)>-1)return typeof t[a]!==r&&(t[a]=r.create(t[a])),this.scrollableView=t[a],void(this.#l=!0);e(t[a].views)}};e(this.views)}return this.#l}set scrollable(e){throw new Error("[scrollable] is readonly prop.")}setProps(e){return Object.keys(e).forEach((t=>this.setProp(t,e[t]))),this}setProp(e,t){return"id"===e&&(this.id=t),this.props[e]=t,this}setViews(e){return this.views=e,this.#l=void 0,this}setEvents(e){return Object.keys(e).forEach((t=>this.setEvent(t,e[t]))),this}setEvent(e,t){return this.events[e]=t,this}eventMiddleware(e,t){const i=this.events[e];return this.events[e]=(...e)=>{"function"==typeof i&&t(i,...e)},this}assignEvent(e,t){const i=this.events[e];return this.events[e]=(...e)=>{"function"==typeof i&&i(...e),t(...e)},this}setLayout(e){return this.layout=e,this}getView(){return this}get definition(){return this.getView()}}e.exports={View:r,PageView:class extends r{constructor(e={}){super(e),this.activeStatus=!0}show(){$(this.props.id).hidden=!1,this.activeStatus=!0}hide(){$(this.props.id).hidden=!0,this.activeStatus=!1}setHorizontalSafeArea(e){return this.horizontalSafeArea=e,this}#c(e,t){e.top.bottom.equalTo(t.super),this.horizontalSafeArea?e.left.right.equalTo(t.super.safeArea):e.left.right.equalTo(t.super)}getView(){return this.layout=this.#c,this.props.clipsToBounds=!0,this.props.hidden=!this.activeStatus,super.getView()}}}})),parcelRequire.register("cgaQ6",(function(e,t){var i=parcelRequire("czAIJ").VERSION;class r{startTime=Date.now();isUseJsboxNav=!1;title=$addin?.current?.name;constructor(){$app.isDebugging&&this.debug()}static isTaio=$app.info.bundleID.includes("taio");static l10n(e,t,i=!0){if("string"==typeof t){const e={};t.split(";").forEach((t=>{if(""!==(t=t.trim())){const i=t.split("=");e[i[0].trim().slice(1,-1)]=i[1].trim().slice(1,-1)}})),t=e}const r=$app.strings;r[e]=i?Object.assign($app.strings[e],t):Object.assign(t,$app.strings[e]),$app.strings=r}static compressImage(e,t=921600){const i=$imagekit.info(e);if(i.height*i.width>t){const r=t/(i.height*i.width);e=$imagekit.scaleBy(e,r)}return e}static quickLookImage(e,t=$l10n("PREVIEW")){const{Sheet:i}=parcelRequire("aXWmO");(new i).setView({type:"view",views:[{type:"scroll",props:{zoomEnabled:!0,maxZoomScale:3},layout:$layout.fill,views:[{type:"image",props:{data:e},layout:$layout.fill}]}],layout:$layout.fill}).addNavBar({title:t,rightButtons:[{symbol:"square.and.arrow.up",tapped:()=>$share.sheet(e)}]}).init().present()}static objectEqual(e,t){let i=Object.getOwnPropertyNames(e),a=Object.getOwnPropertyNames(t);if(i.length!==a.length)return!1;for(let a=0;a<i.length;a++){let s=i[a],o=e[s],n=t[s];if(Array.isArray(o)){for(let e=0;e<o.length;e++)if(!r.objectEqual(o[e],n[e]))return!1}else{if("object"==typeof o)return r.objectEqual(o,n);if(o!==n)return!1}}return!0}static versionCompare(e="",t=""){let i=e.split("."),r=t.split("."),a=Math.max(i.length,r.length),s=0;for(let e=0;e<a;++e){let t=i.length>e?i[e]:0,a=isNaN(Number(t))?t.charCodeAt():Number(t),o=r.length>e?r[e]:0,n=isNaN(Number(o))?o.charCodeAt():Number(o);if(a<n){s=-1;break}if(a>n){s=1;break}}return s}static deleteConfirm(e,t){$ui.alert({title:$l10n("DELETE_CONFIRM_TITLE"),message:e,actions:[{title:$l10n("DELETE"),style:$alertActionType.destructive,handler:()=>{t()}},{title:$l10n("CANCEL")}]})}static bytesToSize(e){if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,t)).toPrecision(3)+" "+["B","KB","MB","GB","TB","PB","EB","ZB","YB"][t]}debug(e,t){this.debugMode=!0,$app.idleTimerDisabled=!0,"function"==typeof e&&(this.debugPrint=e),"function"==typeof t&&(this.debugError=t),this.print("You are running EasyJsBox in debug mode.")}print(e){this.debugMode&&("function"==typeof this.debugPrint?this.debugPrint(e):console.log(e))}error(e){this.debugMode&&("function"==typeof this.debugError?this.debugError(e):console.error(e))}useJsboxNav(){return this.isUseJsboxNav=!0,this}setTitle(e){this.isUseJsboxNav&&($ui.title=e),this.title=e}setNavButtons(e){this.navButtons=e}openInJsbox(){$app.openURL(`jsbox://run?name=${this.title}`)}UIRender(e={}){const t=$context.query;if("alertFromKeyboard"===t.type){const e=JSON.parse($text.URLDecode(t.value));return e.actions=[{title:$l10n("CANCEL")}],void $ui.alert(e)}try{e.props=Object.assign({title:this.title,navBarHidden:!this.isUseJsboxNav,navButtons:this.navButtons??[],statusBarStyle:0},e.props),e.events||(e.events={});const t=e.events.layoutSubviews,{UIKit:i}=parcelRequire("45Ip7");e.events.layoutSubviews=()=>{$app.notify({name:"interfaceOrientationEvent",object:{statusBarOrientation:i.statusBarOrientation,isHorizontal:i.isHorizontal}}),"function"==typeof t&&t()},$ui.render(e)}catch(e){this.print(e)}}KeyboardRender(e={}){e.id||(e.id=$text.uuid),$ui.render({events:e.events??{}}),$delay(0,(()=>{$ui.controller.view=$ui.create(e),$ui.controller.view.layout(e.layout)}))}async checkUpdate(){const e=await $http.get("https://raw.githubusercontent.com/ipuppet/EasyJsBox/dev/src/version.js");if(e.error)throw e.error;const t=srcRes.data.match(/.*VERSION.?\"([0-9\.]+)\"/)[1];if(this.print(`easy-jsbox latest version: ${t}`),r.versionCompare(t,i)>0){const e=await $http.get("https://raw.githubusercontent.com/ipuppet/EasyJsBox/dev/dist/easy-jsbox.js");if(e.error)throw e.error;return e.data}return!1}}r.l10n("zh-Hans",{DELETE_CONFIRM_TITLE:"删除前确认"},!1),r.l10n("en",{DELETE_CONFIRM_TITLE:"Delete Confirmation"},!1),e.exports={Kernel:r}})),parcelRequire.register("czAIJ",(function(e,t){e.exports={VERSION:"1.4.3"}})),parcelRequire.register("dcStC",(function(e,t){var i=parcelRequire("liCrE").View,r=parcelRequire("fYz8N").Controller,a=parcelRequire("45Ip7").UIKit;class s extends i{static largeTitleDisplayModeAutomatic=0;static largeTitleDisplayModeAlways=1;static largeTitleDisplayModeNever=2;static pageSheetNavigationBarHeight=56;navigationBarItems;title="";prefersLargeTitles=!0;largeTitleDisplayMode=s.largeTitleDisplayModeAutomatic;fontFamily="bold";largeTitleFontSize=34;largeTitleFontHeight=$text.sizeThatFits({text:"A",width:100,font:$font(this.fontFamily,this.largeTitleFontSize)}).height;navigationBarTitleFontSize=17;topSafeArea=!0;contentViewHeightOffset=10;navigationBarNormalHeight=a.NavigationBarNormalHeight;navigationBarLargeTitleHeight=a.NavigationBarLargeTitleHeight;setTopSafeArea(){return this.topSafeArea=!0,this}removeTopSafeArea(){return this.topSafeArea=!1,this}setLargeTitleDisplayMode(e){return this.largeTitleDisplayMode=e,this}setBackgroundColor(e){return this.backgroundColor=e,this}setTitle(e){return this.title=e,this}setPrefersLargeTitles(e){return this.prefersLargeTitles=e,this}setContentViewHeightOffset(e){return this.contentViewHeightOffset=e,this}getLargeTitleView(){return this.prefersLargeTitles&&this.largeTitleDisplayMode!==s.largeTitleDisplayModeNever?{type:"label",props:{id:this.id+"-large-title",text:this.title,textColor:a.textColor,align:$align.left,font:$font(this.fontFamily,this.largeTitleFontSize),line:1},layout:(e,t)=>{e.left.equalTo(t.super.safeArea).offset(15),e.height.equalTo(this.largeTitleFontHeight),e.top.equalTo(t.super.safeAreaTop).offset(this.navigationBarNormalHeight)}}:{props:{id:this.id+"-large-title"},layout:(e,t)=>{e.left.top.right.inset(0),e.bottom.equalTo(t.super.safeAreaTop).offset(this.navigationBarNormalHeight)}}}getNavigationBarView(){const e=(e,t)=>{const i=(e,i)=>{e.top.equalTo(i.super.safeAreaTop),e.bottom.equalTo(i.super.safeAreaTop).offset(this.navigationBarNormalHeight),t===a.align.left?e.left.equalTo(i.super.safeArea):e.right.equalTo(i.super.safeArea)};if(e&&!Array.isArray(e))return{type:"view",views:[e],layout:i};let r=0;const s=[];e.forEach((e=>{r+=e.width,s.push(e.definition)}));const o=e[0]?.edges??0;return r+=e.length>=2?2*o:o,e.length>0?{type:"view",views:s,info:{width:r},layout:(e,t)=>{i(e,t),e.width.equalTo(r)}}:{type:"view",layout:e=>e.size.equalTo(0)}},t=e(this.navigationBarItems.popButtonView??this.navigationBarItems.leftButtons,a.align.left),i=e(this.navigationBarItems.rightButtons,a.align.right),r=this.prefersLargeTitles,o=!this.prefersLargeTitles||this.largeTitleDisplayMode===s.largeTitleDisplayModeNever;return{type:"view",props:{id:this.id+"-navigation",bgcolor:$color("clear")},layout:(e,t)=>{e.left.top.right.inset(0),e.bottom.equalTo(t.super.safeAreaTop).offset(this.navigationBarNormalHeight)},views:[this.backgroundColor?{type:"view",props:{hidden:r,bgcolor:this.backgroundColor,id:this.id+"-background"},layout:$layout.fill}:a.blurBox({hidden:r,id:this.id+"-background"}),a.separatorLine({id:this.id+"-underline",alpha:r?0:1}),{type:"view",props:{alpha:0,bgcolor:$color("clear"),id:this.id+"-large-title-mask"},events:{ready:e=>{e.bgcolor=$(this.id+"-large-title")?.prev.bgcolor}},layout:$layout.fill},t,i,{type:"view",views:[{type:"label",props:{id:this.id+"-small-title",alpha:o?1:0,text:this.title,font:$font(this.fontFamily,this.navigationBarTitleFontSize),align:$align.center,bgcolor:$color("clear"),textColor:a.textColor},layout:(e,r)=>{e.edges.equalTo(r.super.safeArea);const s=a.getContentSize($font(this.fontFamily,this.navigationBarTitleFontSize),r.text).width,o=Math.max(t.info?.width??0,i.info?.width??0);a.windowSize.width-2*o>s&&e.centerX.equalTo(r.super.super)}}],layout:(e,t)=>{e.top.bottom.equalTo(t.super.safeArea),e.left.equalTo(t.prev.prev.right),e.right.equalTo(t.prev.left)}}]}}}class o extends r{static largeTitleViewSmallMode=0;static largeTitleViewLargeMode=1;navigationBar;updateSelector(){this.selector={navigation:$(this.navigationBar.id+"-navigation"),largeTitleView:$(this.navigationBar.id+"-large-title"),smallTitleView:$(this.navigationBar.id+"-small-title"),underlineView:this.navigationBar.navigationBarItems.isPinTitleView?$(this.navigationBar.id+"-title-view-underline"):$(this.navigationBar.id+"-underline"),largeTitleMaskView:$(this.navigationBar.id+"-large-title-mask"),backgroundView:$(this.navigationBar.id+"-background"),titleViewBackgroundView:$(this.navigationBar.id+"-title-view-background")}}toNormal(e=!0){this.updateSelector(),this.selector.backgroundView.hidden=!1,$ui.animate({duration:.2,animation:()=>{this.selector.underlineView.alpha=1,this.selector.smallTitleView.alpha=1,this.selector.largeTitleView.alpha=0}}),e&&this.navigationBar.navigationBarItems&&(this.navigationBar.largeTitleDisplayMode=s.largeTitleDisplayModeNever)}toLargeTitle(e=!0){this.updateSelector(),this.selector.backgroundView.hidden=!0,$ui.animate({duration:.2,animation:()=>{this.selector.underlineView.alpha=0,this.selector.smallTitleView.alpha=0,this.selector.largeTitleView.alpha=1}}),e&&this.navigationBar.navigationBarItems&&(this.navigationBar.largeTitleDisplayMode=s.largeTitleDisplayModeAlways)}#d(e){const t=e===o.largeTitleViewSmallMode;this.selector.largeTitleView.alpha=t?0:1,$ui.animate({duration:.2,animation:()=>{this.selector.smallTitleView.alpha=t?1:0}})}#u(e){if(this.selector.largeTitleView.updateLayout(((t,i)=>{this.navigationBar.navigationBarNormalHeight-e>0?t.top.equalTo(i.super.safeAreaTop).offset(this.navigationBar.navigationBarNormalHeight-e):t.top.equalTo(i.super.safeAreaTop).offset(0)})),e>0)e>=this.navigationBar.navigationBarNormalHeight?this.#d(o.largeTitleViewSmallMode):this.#d(o.largeTitleViewLargeMode);else{this.#d(o.largeTitleViewLargeMode);let t=this.navigationBar.largeTitleFontSize-.04*e;t>40&&(t=40),this.selector.largeTitleView.font=$font(this.navigationBar.fontFamily,t)}}#p(e){const t=this.navigationBar.largeTitleDisplayMode===s.largeTitleDisplayModeNever?5:this.navigationBar.navigationBarNormalHeight,i=void 0!==this.selector.titleViewBackgroundView;if(e>t){this.selector.backgroundView.hidden=!1;const r=()=>{i&&this.navigationBar.navigationBarItems.isPinTitleView&&(this.selector.titleViewBackgroundView.alpha=1),this.selector.largeTitleMaskView.alpha=0,this.selector.underlineView.alpha=1};(e-t)/3>=1?r():$ui.animate({duration:.2,animation:()=>{r()}})}else this.selector.largeTitleMaskView.alpha=e>0?1:0,this.selector.underlineView.alpha=0,i&&(this.selector.titleViewBackgroundView.alpha=0),this.selector.backgroundView.hidden=!0}didScroll(e){if(!this.navigationBar.prefersLargeTitles)return;const t=this.navigationBar.largeTitleDisplayMode;if(t!==s.largeTitleDisplayModeAlways)if(this.updateSelector(),t===s.largeTitleDisplayModeAutomatic){if(!this.navigationBar.navigationBarItems?.isPinTitleView&&(this.navigationBar.navigationBarItems?.titleView?.controller.didScroll(e),e>0)){(e-=this.navigationBar.navigationBarItems?.titleView?.height??0)<0&&(e=0)}this.#u(e),this.#p(e)}else t===s.largeTitleDisplayModeNever&&this.#p(e)}didEndDragging(e,t,i,r){if(!this.navigationBar.prefersLargeTitles)return;const a=this.navigationBar.largeTitleDisplayMode;if(a!==s.largeTitleDisplayModeAlways&&(this.updateSelector(),a===s.largeTitleDisplayModeAutomatic)){let a=0;this.navigationBar.navigationBarItems?.isPinTitleView||(this.navigationBar.navigationBarItems?.titleView?.controller.didEndDragging(e,t,i,r),a=this.navigationBar.navigationBarItems?.titleView?.height??0,e-=a),e>=0&&e<=this.navigationBar.largeTitleFontHeight&&i($point(0,e>=this.navigationBar.largeTitleFontHeight/2?this.navigationBar.navigationBarNormalHeight+a-r:a-r))}}}e.exports={NavigationBar:s,NavigationBarController:o}})),parcelRequire.register("gAYmG",(function(e,t){var i=parcelRequire("liCrE").View,r=parcelRequire("45Ip7").UIKit;class a extends i{static#g;edges=15;buttonEdges=this.edges/2;iconSize=24;fontSize=17;color=r.textColor;title;#$;align=r.align.right;get symbol(){return this.#$}set symbol(e){this.#$="string"==typeof e?$image(e):e}get width(){if(this.title){const e=$text.sizeThatFits({text:this.title,width:r.windowSize.width,font:$font(this.fontSize)});return Math.ceil(e.width)+this.edges}return this.iconSize+this.edges}static get style(){return void 0===this.#g&&(this.#g=new a),this.#g}setEdges(e){return this.edges=e,this}setFontSize(e){return this.fontSize=e,this}setColor(e=r.textColor){return this.color=e,this}setTitle(e){return this.title=e,this}setSymbol(e){return this.symbol=e,this}setMenu(e){return this.menu=e,this}setAlign(e){return this.align=e,this}setLoading(e){e?($(this.id).hidden=!0,$("spinner-"+this.id).hidden=!1):($(this.id).hidden=!1,$("spinner-"+this.id).hidden=!0)}#f(){const e=$(`icon-button-${this.id}`),t=$(`icon-checkmark-${this.id}`);e.alpha=0,$(this.id).hidden=!1,$("spinner-"+this.id).hidden=!0,$ui.animate({duration:.6,animation:()=>{t.alpha=1},completion:()=>{$delay(.3,(()=>$ui.animate({duration:.6,animation:()=>{t.alpha=0},completion:()=>{$ui.animate({duration:.4,animation:()=>{e.alpha=1},completion:()=>{e.alpha=1}})}})))}})}getView(){const e=this.events.tapped;return this.events.tapped=t=>{e&&e({start:()=>this.setLoading(!0),done:()=>this.#f(),cancel:()=>this.setLoading(!1)},t)},{type:"view",props:{info:{align:this.align}},views:[{type:"button",props:Object.assign({id:this.id,bgcolor:$color("clear"),font:$font(this.fontSize),titleColor:this.color,contentEdgeInsets:$insets(0,0,0,0),titleEdgeInsets:$insets(0,0,0,0),imageEdgeInsets:$insets(0,0,0,0)},this.menu?{menu:this.menu}:{},this.title?{title:this.title}:{},this.props),views:[{type:"image",props:Object.assign({id:`icon-button-${this.id}`,hidden:void 0===this.symbol,tintColor:this.color},this.symbol?{image:this.symbol}:{}),layout:(e,t)=>{this.symbol&&e.size.equalTo(r.getSymbolSize(this.symbol,this.iconSize)),e.center.equalTo(t.super)}},{type:"image",props:{id:`icon-checkmark-${this.id}`,alpha:0,tintColor:this.color,symbol:"checkmark"},layout:(e,t)=>{e.center.equalTo(t.super),e.size.equalTo(r.getSymbolSize("checkmark",this.iconSize))}}],events:this.events,layout:$layout.fill},{type:"spinner",props:{id:"spinner-"+this.id,loading:!0,hidden:!0},layout:$layout.fill}],layout:(e,t)=>{if(e.size.equalTo($size(this.width,r.NavigationBarNormalHeight)),e.centerY.equalTo(t.super),t.prev&&t.prev?.info?.align===this.align)this.align===r.align.right?e.right.equalTo(t.prev.left).offset(-this.buttonEdges):e.left.equalTo(t.prev.right).offset(this.buttonEdges);else{const t=this.edges/2;this.align===r.align.right?e.right.inset(t):e.left.inset(t)}}}}static creat({id:e,symbol:t,title:i,tapped:s,menu:o,events:n,color:l,align:h=r.align.right}={}){const c=new a;return c.setEvents(Object.assign({tapped:s},n)).setAlign(h).setSymbol(t).setTitle(i).setColor(l).setMenu(o),e&&c.setProp("id",e),c}}e.exports={BarTitleView:class extends i{controller={};setController(e){return this.controller=e,this}},BarButtonItem:a,NavigationBarItems:class{rightButtons=[];leftButtons=[];#b={};hasbutton=!1;isPinTitleView=!1;setTitleView(e){return this.titleView=e,this}pinTitleView(){return this.isPinTitleView=!0,this}setFixedFooterView(e){return this.fixedFooterView=e,this}setRightButtons(e){return e.forEach((e=>this.addRightButton(e))),this.hasbutton||(this.hasbutton=!0),this}setLeftButtons(e){return e.forEach((e=>this.addLeftButton(e))),this.hasbutton||(this.hasbutton=!0),this}addRightButton({id:e,symbol:t,title:i,tapped:s,menu:o,events:n,color:l}={}){const h=a.creat({id:e,symbol:t,title:i,tapped:s,menu:o,events:n,color:l,align:r.align.right});return this.rightButtons.push(h),this.#b[e??h.id]=h,this.hasbutton||(this.hasbutton=!0),this}addLeftButton({id:e,symbol:t,title:i,tapped:s,menu:o,events:n,color:l}={}){const h=a.creat({id:e,symbol:t,title:i,tapped:s,menu:o,events:n,color:l,align:r.align.left});return this.leftButtons.push(h),this.#b[e??h.id]=h,this.hasbutton||(this.hasbutton=!0),this}getButton(e){return this.#b[e]}addPopButton(e,t,i){return e||(e=$l10n("BACK")),this.popButtonView=t??{type:"button",props:{bgcolor:$color("clear"),symbol:"chevron.left",tintColor:r.linkColor,title:` ${e}`,titleColor:r.linkColor,font:$font("bold",16)},layout:(e,t)=>{e.left.equalTo(t.super.safeArea).offset(a.style.edges),e.centerY.equalTo(t.super.safeArea)},events:{tapped:()=>{$ui.pop(),"function"==typeof i&&i()}}},this}removePopButton(){return this.popButtonView=void 0,this}}}})),parcelRequire.register("22IPG",(function(module,exports){var $8aDdQ=parcelRequire("8aDdQ"),$17ce8b7af98fa095$require$FileStorageFileNotFoundError=$8aDdQ.FileStorageFileNotFoundError,$cgaQ6=parcelRequire("cgaQ6"),$17ce8b7af98fa095$require$Kernel=$cgaQ6.Kernel,$45Ip7=parcelRequire("45Ip7"),$17ce8b7af98fa095$require$UIKit=$45Ip7.UIKit,$12xzj=parcelRequire("12xzj"),$17ce8b7af98fa095$require$NavigationView=$12xzj.NavigationView,$dcStC=parcelRequire("dcStC"),$17ce8b7af98fa095$require$NavigationBar=$dcStC.NavigationBar;class SettingItem{static rowHeight=50;static edgeOffset=10;static iconSize=30;static iconDefaultColor="#00CC00";setting;method;#v;#m;#w;title;#y=[];constructor(e,t,i,r){this.setting=e,this.method=this.setting?.method??{},this.key=t,this.title=i,this.icon=r}set key(e){return this.#m=e??$text.uuid,this.#v=void 0,this}get key(){return this.#m}get id(){return this.#v||(this.#v=`setting-${this.setting.name}-${this.key}`),this.#v}set icon(e){return e?Array.isArray(e)||(e=[e,SettingItem.iconDefaultColor]):e=["square.grid.2x2.fill",SettingItem.iconDefaultColor],Array.isArray(e[0])||(e[0]=[e[0],e[0]]),e[1]?Array.isArray(e[1])||(e[1]=[e[1],e[1]]):e[1]=[SettingItem.iconDefaultColor,SettingItem.iconDefaultColor],this.#w=e,this}get icon(){return this.#w}set(e){return this.setting.set(this.key,e)}get(e=null){return this.setting.getOriginal(this.key,e)}evalValues(object){let result;return result="string"==typeof object?object.startsWith("this.method")?eval(`(()=>{return ${object}()})()`):eval(`(()=>{return ${object}})()`):"function"==typeof object?object():object??[],result}getId(e){return`setting-${this.setting.name}-${e}`}createLineLabel(){return{type:"view",views:[{type:"view",props:{bgcolor:$color(this.icon[1][0],this.icon[1][1]),cornerRadius:5,smoothCorners:!0},views:[{type:"image",props:{tintColor:$color("white"),image:$image(this.icon[0][0],this.icon[0][1])},layout:(e,t)=>{e.center.equalTo(t.super),e.size.equalTo(20)}}],layout:(e,t)=>{e.centerY.equalTo(t.super),e.size.equalTo(SettingItem.iconSize),e.left.inset(SettingItem.edgeOffset)}},{type:"label",props:{text:this.title,lines:1,align:$align.left},layout:(e,t)=>{e.centerY.equalTo(t.super),e.height.equalTo(t.super),e.left.equalTo(t.prev.right).offset(SettingItem.edgeOffset),e.width.greaterThanOrEqualTo(10)}}],layout:(e,t)=>{e.height.centerY.equalTo(t.super),e.left.inset(0)}}}options(...e){return this.#y=e??[],this}getView(){}create(){return this.getView(...this.#y)}static from(e){return new this(e.setting,e.key,e.title,e.icon)}}class SettingInfo extends SettingItem{getView(e){const t=Array.isArray(e),i=t?e[0]:e,r=t?e[1]:e;return{type:"view",props:{selectable:!0},views:[this.createLineLabel(),{type:"label",props:{text:i,align:$align.right,textColor:$color("darkGray")},layout:(e,t)=>{e.centerY.equalTo(t.prev),e.right.inset(SettingItem.edgeOffset),e.width.equalTo(180)}},{type:"view",events:{tapped:()=>{$ui.alert({title:this.title,message:r,actions:[{title:$l10n("COPY"),handler:()=>{$clipboard.text=r,$ui.toast($l10n("COPIED"))}},{title:$l10n("OK")}]})}},layout:(e,t)=>{e.right.inset(0),e.size.equalTo(t.super)}}],layout:$layout.fill}}}class SettingSwitch extends SettingItem{getView(){return{type:"view",props:{id:this.id,selectable:!0},views:[this.createLineLabel(),{type:"switch",props:{on:this.get(),onColor:$color("#00CC00")},events:{changed:e=>{try{this.set(e.on)}catch(t){throw e.on=!e.on,t}}},layout:(e,t)=>{e.centerY.equalTo(t.prev),e.right.inset(SettingItem.edgeOffset)}}],layout:$layout.fill}}}class SettingString extends SettingItem{getView(){return{type:"view",props:{id:this.id,selectable:!0},views:[this.createLineLabel(),{type:"button",props:{symbol:"square.and.pencil",bgcolor:$color("clear"),tintColor:$color("primaryText")},events:{tapped:e=>{const t=$ui.popover({sourceView:e,sourceRect:e.bounds,directions:$popoverDirection.down,size:$size(320,150),views:[{type:"text",props:{id:`${this.id}-string`,align:$align.left,text:this.get()},layout:e=>{e.left.right.inset(10),e.top.inset(20),e.height.equalTo(90)}},{type:"button",props:{symbol:"checkmark",bgcolor:$color("clear"),titleEdgeInsets:10,contentEdgeInsets:0},layout:e=>{e.right.inset(10),e.bottom.inset(25),e.size.equalTo(30)},events:{tapped:()=>{this.set($(`${this.id}-string`).text),t.dismiss()}}}]})}},layout:(e,t)=>{e.centerY.equalTo(t.prev),e.right.inset(0),e.size.equalTo(50)}}],layout:$layout.fill}}}class SettingStepper extends SettingItem{getView(e,t){const i=`${this.id}-label`;return{type:"view",props:{id:this.id,selectable:!0},views:[this.createLineLabel(),{type:"label",props:{id:i,text:this.get(),align:$align.left},layout:(e,t)=>{e.height.equalTo(t.super),e.right.inset(120)}},{type:"stepper",props:{min:e,max:t,value:this.get()},events:{changed:e=>{$(i).text=e.value;try{this.set(e.value)}catch(e){throw $(i).text=this.get(),e}}},layout:(e,t)=>{e.centerY.equalTo(t.prev),e.right.inset(SettingItem.edgeOffset)}}],layout:$layout.fill}}}class SettingScript extends SettingItem{#S;#T(){$(this.id).bgcolor=$color("systemFill")}#q(e=.3){0===e?$(this.id).bgcolor=$color("clear"):$ui.animate({duration:e,animation:()=>{$(this.id).bgcolor=$color("clear")}})}#B(e,t=!1,i=0){if(e=Object.assign(e,{touchesBegan:()=>{this.#T(),this.#S=$delay(1,(()=>this.#q(0)))},touchesMoved:()=>{this.#S?.cancel(),this.#q(0)}}),t){const t=e.tapped;e.tapped=()=>{this.#T(),$delay(i,(()=>this.#q())),"function"==typeof t&&t()}}return e}getView(script){const buttonId=`${this.id}-button`,rightSymbol="chevron.right",start=()=>{$(buttonId).alpha=0,$(`${buttonId}-spinner`).alpha=1,this.#T()},cancel=()=>{$(buttonId).alpha=1,$(`${buttonId}-spinner`).alpha=0,this.#q()},done=()=>{$(`${buttonId}-spinner`).alpha=0,this.#q();const e=$(buttonId);e.symbol="checkmark",$ui.animate({duration:.6,animation:()=>e.alpha=1,completion:()=>{$ui.animate({duration:.4,animation:()=>e.alpha=0,completion:()=>{e.symbol=rightSymbol,$ui.animate({duration:.4,animation:()=>e.alpha=1})}})}}),$delay(.6,(()=>{}))};return{type:"view",props:{id:this.id},views:[this.createLineLabel(),{type:"view",views:[{type:"button",props:{id:buttonId,symbol:rightSymbol,bgcolor:$color("clear"),tintColor:$color("secondaryText")},layout:(e,t)=>{e.centerY.equalTo(t.super),e.right.inset(0),e.height.equalTo(t.super)}},{type:"spinner",props:{id:`${buttonId}-spinner`,loading:!0,alpha:0},layout:(e,t)=>{e.size.equalTo(15),e.centerY.equalTo(t.super),e.right.equalTo(t.prev)}}],layout:(e,t)=>{e.right.inset(SettingItem.edgeOffset),e.height.equalTo(SettingItem.rowHeight),e.width.equalTo(t.super)}},{type:"view",layout:$layout.fill}],events:this.#B({tapped:()=>{const animate={start:start,cancel:cancel,done:done,touchHighlightStart:()=>this.#T(),touchHighlightEnd:()=>this.#q()};"function"==typeof script?script(animate):script.startsWith("this.method")?eval(`(()=>{return ${script}(animate)})()`):eval(script)}}),layout:$layout.fill}}}class SettingTab extends SettingItem{getView(e,t){e=this.evalValues(e),t=this.evalValues(t);const i=e?.length>0&&t?.length===e?.length;return{type:"view",props:{id:this.id,selectable:!0},views:[this.createLineLabel(),{type:"tab",props:{items:e??[],index:i?t.indexOf(this.get()):this.get(),dynamicWidth:!0},layout:(e,t)=>{e.right.inset(SettingItem.edgeOffset),e.centerY.equalTo(t.prev)},events:{changed:e=>{i?this.set(t[e.index]):this.set(e.index)}}}],layout:$layout.fill}}}class SettingMenu extends SettingItem{getView(e,t,i){const r=`${this.id}-label`,a=this.evalValues(e),s=this.evalValues(t),o=a?.length>0&&s?.length===a?.length,n=(e,i)=>{if(o){const e=this.evalValues(t);this.set(e[i])}else this.set(i);$(r).title=e},l=()=>{i||$ui.menu({items:this.evalValues(e),handler:n})};return{type:"view",props:{id:this.id,selectable:!0},views:[this.createLineLabel(),{type:"view",views:[{type:"button",props:{menu:i?{pullDown:!0,asPrimary:!0,items:a.map(((e,t)=>({title:e,handler:()=>n(e,t)})))}:void 0,title:o?a[s.indexOf(this.get())]:a[this.get()],titleColor:$color("secondaryText"),bgcolor:$color("clear"),id:r},events:{tapped:l},layout:(e,t)=>{e.right.inset(0),e.height.equalTo(t.super)}}],layout:(e,t)=>{e.right.inset(SettingItem.edgeOffset),e.height.equalTo(SettingItem.rowHeight),e.width.equalTo(t.super)}}],events:{tapped:l},layout:$layout.fill}}}class SettingColor extends SettingItem{get(e=null){const t=super.get(e);return t?"string"==typeof t?$color(t):$rgba(t.red,t.green,t.blue,t.alpha):e}getView(){const e=`${this.id}-color`;return{type:"view",props:{id:this.id,selectable:!0},views:[this.createLineLabel(),{type:"view",views:[{type:"view",props:{id:e,bgcolor:this.get(),circular:!0,borderWidth:1,borderColor:$color("#e3e3e3")},layout:(e,t)=>{e.centerY.equalTo(t.super),e.right.inset(SettingItem.edgeOffset),e.size.equalTo(20)}},{type:"view",events:{tapped:async()=>{const t=await $picker.color({color:this.get()});this.set(t.components),$(e).bgcolor=$rgba(t.components.red,t.components.green,t.components.blue,t.components.alpha)}},layout:(e,t)=>{e.right.inset(0),e.height.width.equalTo(t.super.height)}}],layout:(e,t)=>{e.height.equalTo(SettingItem.rowHeight),e.width.equalTo(t.super)}}],layout:$layout.fill}}}class SettingDate extends SettingItem{getView(e=2){const t=t=>{let i="";switch("number"==typeof t&&(t=new Date(t)),e){case 0:i=t.toLocaleTimeString();break;case 1:i=t.toLocaleDateString();break;case 2:i=t.toLocaleString()}return i};return{type:"view",props:{id:this.id,selectable:!0},views:[this.createLineLabel(),{type:"view",views:[{type:"label",props:{id:`${this.id}-label`,color:$color("secondaryText"),text:this.get()?t(this.get()):"None"},layout:(e,t)=>{e.right.inset(0),e.height.equalTo(t.super)}}],events:{tapped:async()=>{const i=this.get(),r=await $picker.date({props:{mode:e,date:i||Date.now()}});this.set(r.getTime()),$(`${this.id}-label`).text=t(r)}},layout:(e,t)=>{e.right.inset(SettingItem.edgeOffset),e.height.equalTo(SettingItem.rowHeight),e.width.equalTo(t.super)}}],layout:$layout.fill}}}class SettingInput extends SettingItem{getView(e=!1,t=$kbType.default,i){void 0===i&&(i=e=>this.set(e));const r=this.id+"-input";return{type:"view",props:{id:this.id,selectable:!0},views:[this.createLineLabel(),{type:"input",props:{id:r,type:t,align:$align.right,bgcolor:$color("clear"),textColor:$color("secondaryText"),text:this.get(),font:$font(16),secure:e,accessoryView:$17ce8b7af98fa095$require$UIKit.blurBox({height:44},[$17ce8b7af98fa095$require$UIKit.separatorLine({},$17ce8b7af98fa095$require$UIKit.align.top),{type:"button",props:{title:$l10n("DONE"),bgcolor:$color("clear"),titleColor:$color("primaryText")},layout:(e,t)=>{e.right.inset(SettingItem.edgeOffset),e.centerY.equalTo(t.super)},events:{tapped:()=>{$(r).blur()}}},{type:"button",props:{title:$l10n("CANCEL"),bgcolor:$color("clear"),titleColor:$color("primaryText")},layout:(e,t)=>{e.left.inset(SettingItem.edgeOffset),e.centerY.equalTo(t.super)},events:{tapped:()=>{const e=$(r),t=this.get("");e.text!==t&&(e.text=t),e.blur()}}}])},layout:(e,t)=>{e.left.equalTo(t.prev.get("label").right).offset(SettingItem.edgeOffset),e.right.inset(SettingItem.edgeOffset);const i=$17ce8b7af98fa095$require$UIKit.getContentSize($font(16),this.get("")).width;e.width.greaterThanOrEqualTo(i+30),e.height.equalTo(t.super)},events:{didBeginEditing:e=>{e.secure=!1,$app.autoKeyboardEnabled||($app.autoKeyboardEnabled=!0)},returned:e=>{e.blur()},didEndEditing:async t=>{const r=this.get("");i(t.text)||(t.text=r),e&&(t.secure=e)}}}],layout:$layout.fill}}}class SettingNumber extends SettingItem{getView(){return SettingInput.from(this).getView(!1,$kbType.decimal,(e=>""!==e&&/^[0-9]+.?[0-9]*$/.test(e)?this.set(Number(e)):($ui.toast($l10n("INVALID_VALUE")),!1)))}}class SettingIcon extends SettingItem{getView(e="#000000"){const t=`${this.id}-image`;return{type:"view",props:{id:this.id,selectable:!0},views:[this.createLineLabel(),{type:"view",views:[{type:"image",props:{cornerRadius:8,bgcolor:"string"==typeof e?$color(e):e,smoothCorners:!0},layout:(e,t)=>{e.right.inset(SettingItem.edgeOffset),e.centerY.equalTo(t.super),e.size.equalTo($size(30,30))}},{type:"image",props:{id:t,image:$image(this.get()),icon:$icon(this.get()?.slice(5,this.get().indexOf(".")),$color("#ffffff")),tintColor:$color("#ffffff")},layout:(e,t)=>{e.right.equalTo(t.prev).offset(-5),e.centerY.equalTo(t.super),e.size.equalTo($size(20,20))}}],events:{tapped:()=>{$ui.menu({items:[$l10n("JSBOX_ICON"),$l10n("SF_SYMBOLS"),$l10n("IMAGE_BASE64")],handler:async(e,i)=>{if(0===i){const e=await $ui.selectIcon();this.set(e),$(t).icon=$icon(e.slice(5,e.indexOf(".")),$color("#ffffff"))}else 1!==i&&2!==i||$input.text({text:"",placeholder:e,handler:e=>{""!==e?(this.set(e),1===i?$(t).symbol=e:$(t).image=$image(e)):$ui.toast($l10n("INVALID_VALUE"))}})}})}},layout:(e,t)=>{e.right.inset(0),e.height.equalTo(SettingItem.rowHeight),e.width.equalTo(t.super)}}],layout:$layout.fill}}}class SettingPush extends SettingItem{method=this.setting.method;getView(view,tapped){return{type:"view",layout:$layout.fill,props:{id:this.id,selectable:!0},views:[this.createLineLabel(),{type:"button",props:{symbol:"chevron.right",bgcolor:$color("clear"),tintColor:$color("secondaryText")},layout:(e,t)=>{e.centerY.equalTo(t.super),e.right.inset(SettingItem.edgeOffset),e.height.equalTo(t.super)}},{type:"view",layout:$layout.fill}],events:{tapped:()=>{const push=view=>{if("string"==typeof view&&view.startsWith("this.method")?view=eval(`(()=>{return ${view}()})()`):"function"==typeof view&&(view=view()),this.setting.isUseJsboxNav)$17ce8b7af98fa095$require$UIKit.push({title:this.title,props:view.props??{},views:[view]});else{const e=new $17ce8b7af98fa095$require$NavigationView;e.setView(view).navigationBarTitle(this.title),e.navigationBarItems.addPopButton(),e.navigationBar.setLargeTitleDisplayMode($17ce8b7af98fa095$require$NavigationBar.largeTitleDisplayModeNever),this.setting.hasSectionTitle(view)&&e.navigationBar.setContentViewHeightOffset(-10),this.setting.viewController.push(e)}};"function"==typeof tapped?tapped(push):push(view)}}}}}class SettingChild extends SettingItem{getView(e){return SettingPush.from(this).getView(void 0,(t=>{this.setting.events?.onChildPush?this.setting.callEvent("onChildPush",this.setting.getListView(e,{}),this.title):t(this.setting.getListView(e,{}))}))}}class SettingImage extends SettingItem{getImagePath(e=!1){let t=$text.MD5(this.key)+".jpg";return e&&(t="compress."+t),this.setting.imagePath+t}getImage(e=!1){try{return this.setting.fileStorage.readSync(this.getImagePath(e))}catch(e){if(e instanceof $17ce8b7af98fa095$require$FileStorageFileNotFoundError)return null;throw e}}get(e=null){return this.getImage(!1)??null}getView(){const e=`${this.id}-image`,t=$image("questionmark.square.dashed"),i=t=>async()=>{$(e).hidden=!0,$(`${e}-spinner`).hidden=!1,await $wait(.1);try{await t()}catch(e){$ui.alert({title:$l10n("ERROR"),message:String(e)})}await $wait(.1),$(`${e}-spinner`).hidden=!0,$(e).hidden=!1},r=[{title:$l10n("PREVIEW"),handler:i((()=>{const e=this.getImage(!1);e?$17ce8b7af98fa095$require$Kernel.quickLookImage(e):$ui.toast($l10n("NO_IMAGE"))}))},{inline:!0,items:[{title:$l10n("SELECT_IMAGE_PHOTO"),handler:i((async()=>{const t=await $photo.pick({format:"data"});if(!t.status||!t.data){if("canceled"!==t?.error?.description)throw new Error(t?.error?.description);return}const i=$17ce8b7af98fa095$require$Kernel.compressImage(t.data.image);this.setting.fileStorage.write(this.getImagePath(!0),i.jpg(.8)),this.setting.fileStorage.write(this.getImagePath(),t.data),$(e).image=i,$ui.success($l10n("SUCCESS"))}))},{title:$l10n("SELECT_IMAGE_ICLOUD"),handler:i((async()=>{const t=await $drive.open();if(!t)return;const i=$17ce8b7af98fa095$require$Kernel.compressImage(t.image);this.setting.fileStorage.write(this.getImagePath(!0),i.jpg(.8)),this.setting.fileStorage.write(this.getImagePath(),t),$(e).image=i,$ui.success($l10n("SUCCESS"))}))}]},{title:$l10n("CLEAR_IMAGE"),destructive:!0,handler:i((()=>{this.setting.fileStorage.delete(this.getImagePath(!0)),this.setting.fileStorage.delete(this.getImagePath()),$(e).image=t,$ui.success($l10n("SUCCESS"))}))}];return{type:"view",props:{id:this.id,selectable:!0},views:[this.createLineLabel(),{type:"view",views:[{type:"image",props:{id:e,image:this.getImage(!0)?.image??t},layout:(e,t)=>{e.right.inset(SettingItem.edgeOffset),e.centerY.equalTo(t.super),e.size.equalTo($size(30,30))}},{type:"spinner",props:{id:`${e}-spinner`,loading:!0,hidden:!0},layout:(e,t)=>{e.size.equalTo(t.prev),e.left.top.equalTo(t.prev)}},{type:"button",props:{menu:{pullDown:!0,asPrimary:!0,items:r},bgcolor:$color("clear")},layout:(e,t)=>{e.right.inset(SettingItem.edgeOffset),e.centerY.equalTo(t.super),e.size.equalTo($size(30,30))}}],layout:(e,t)=>{e.right.inset(0),e.height.equalTo(SettingItem.rowHeight),e.width.equalTo(t.super)}}],layout:$layout.fill}}}module.exports={SettingItem:SettingItem,SettingInfo:SettingInfo,SettingSwitch:SettingSwitch,SettingString:SettingString,SettingStepper:SettingStepper,SettingScript:SettingScript,SettingTab:SettingTab,SettingMenu:SettingMenu,SettingColor:SettingColor,SettingDate:SettingDate,SettingInput:SettingInput,SettingNumber:SettingNumber,SettingIcon:SettingIcon,SettingPush:SettingPush,SettingChild:SettingChild,SettingImage:SettingImage}})),parcelRequire.register("8aDdQ",(function(e,t){class i extends Error{constructor(e){super(`Parameter [${e}] is required.`),this.name="FileStorageParameterError"}}class r extends Error{constructor(e){super(`File not found: ${e}`),this.name="FileStorageFileNotFoundError"}}class a{basePath;constructor({basePath:e="storage"}={}){this.basePath=e,this.#I(this.basePath)}static join(...e){const t=e.length;let i=e[0];if(t<2)return i;for(let r=0;r<t-1;++r){let t=e[r+1];t.startsWith("/")&&(t=t.substring(1)),i=i.endsWith("/")?i+t:i+"/"+t}return i}#I(e){$file.isDirectory(e)||$file.mkdir(e)}filePath(e="",t=!0){let i="";if(!(e=a.join(this.basePath,e)).endsWith("/")){const t=e.lastIndexOf("/");e.lastIndexOf(".")>t&&(i=e.substring(t+1),e=e.substring(0,t+1))}return t&&this.#I(e),e+i}exists(e=""){return e=this.filePath(e,!1),!!$file.exists(e)}write(e="",t){return new Promise(((i,r)=>{try{const a=this.writeSync(e,t);a?i(a):r(a)}catch(e){r(e)}}))}writeSync(e="",t){if(!t)throw new i("data");return $file.write({data:t,path:this.filePath(e)})}read(e=""){return new Promise(((t,i)=>{try{const r=this.readSync(e);r?t(r):i()}catch(e){i(e)}}))}readSync(e=""){if(e=this.filePath(e),!$file.exists(e))throw new r(e);return $file.isDirectory(e)?$file.list(e):$file.read(e)}readAsJSON(e="",t=null){try{const t=this.readSync(e)?.string;return JSON.parse(t)}catch(e){return t}}static readFromRoot(e=""){return new Promise(((t,i)=>{try{const r=a.readFromRootSync(e);r?t(r):i()}catch(e){i(e)}}))}static readFromRootSync(e=""){if(!e)throw new i("path");if(!$file.exists(e))throw new r(e);return $file.isDirectory(e)?$file.list(e):$file.read(e)}static readFromRootAsJSON(e="",t=null){try{const t=a.readFromRootSync(e)?.string;return JSON.parse(t)}catch(e){return t}}delete(e=""){return $file.delete(this.filePath(e,!1))}copy(e,t){e=this.filePath(e),t=this.filePath(t),$file.copy({src:e,dst:t})}move(e,t){e=this.filePath(e),t=this.filePath(t),$file.move({src:e,dst:t})}}e.exports={FileStorageParameterError:i,FileStorageFileNotFoundError:r,FileStorage:a}})),String.prototype.trim=function(e,t){return e?"l"===t?this.replace(new RegExp("^\\"+e+"+","g"),""):"r"===t?this.replace(new RegExp("\\"+e+"+$","g"),""):this.replace(new RegExp("^\\"+e+"+|\\"+e+"+$","g"),""):this.replace(/^\s+|\s+$/g,"")};var $czAIJ=parcelRequire("czAIJ"),$cb554e51cde28d7a$require$VERSION=$czAIJ.VERSION,$0c5cba21965f6942$exports={},$45Ip7=parcelRequire("45Ip7"),$0c5cba21965f6942$require$UIKit=$45Ip7.UIKit;class $0c5cba21965f6942$var$AlertAction{title;handler;constructor({title:e=$l10n("OK"),disabled:t=!1,style:i=$alertActionType.default,handler:r=(()=>{})}={}){this.title=e,this.disabled=t,this.style=i,this.handler=r}}class $0c5cba21965f6942$var$Alert{id=$text.uuid;title;message;actions;titleFont=$font("bold",20);messageFont=$font(14);actionButtonFontSize=16;actionButtonHighlight=$color($rgba(0,0,0,.2),$rgba(255,255,255,.2));actionButtonHeight=35;actionButtonBoderWidth=.5;actionButtonBorderColor=$color("#C9C9C9","#383838");boxWidth=250;textVerticalMargin=20;textHorizontalMargin=50;constructor({title:e="",message:t="",actions:i=[]}={}){this.title=e,this.message=t,this.actions=i,0===this.actions.length&&this.actions.push(new $0c5cba21965f6942$var$AlertAction),this.titleSize=$0c5cba21965f6942$require$UIKit.getContentSize(this.titleFont,this.title,this.boxWidth-2*this.textHorizontalMargin),this.messageSize=$0c5cba21965f6942$require$UIKit.getContentSize(this.messageFont,this.message,this.boxWidth-2*this.textHorizontalMargin)}textView(){return{type:"view",views:[{type:"label",props:{lines:0,font:this.titleFont,text:this.title,color:$color("tint"),align:$align.center},layout:(e,t)=>{e.centerX.equalTo(t.super),e.width.equalTo(this.boxWidth-2*this.textHorizontalMargin),e.height.equalTo(this.titleSize.height),e.top.equalTo(this.textVerticalMargin)}},{type:"label",props:{lines:0,font:this.messageFont,text:this.message,align:$align.center},layout:(e,t)=>{e.centerX.equalTo(t.super),e.width.equalTo(this.boxWidth-2*this.textHorizontalMargin),e.height.equalTo(this.messageSize.height),e.top.equalTo(t.prev.bottom)}}],layout:(e,t)=>{e.top.width.equalTo(t.super),e.height.equalTo(this.titleSize.height+this.messageSize.height+2*this.textVerticalMargin)}}}actionView(){const e=(e,t)=>{const i=e=>2===this.actions.length?e.y>=0&&e.x>=0&&e.y<=this.actionButtonHeight&&e.x<=this.boxWidth/2:e.y>=0&&e.x>=0&&e.y<=this.actionButtonHeight&&e.x<=this.boxWidth,r=async(r,a,s)=>{e.disabled||(r.bgcolor=$color("clear"),i(a)&&("function"==typeof e.handler&&await e.handler({index:t,title:e.title}),this.dismiss()))};let a=$color("tint"),s=$font(this.actionButtonFontSize);return e.disabled?a=$color("gray"):e.style===$alertActionType.destructive?a=$color("red"):e.style===$alertActionType.cancel&&(s=$font("bold",this.actionButtonFontSize)),{type:"label",props:{lines:1,text:e.title,align:$align.center,font:s,color:a,borderWidth:this.actionButtonBoderWidth,borderColor:this.actionButtonBorderColor,bgcolor:$color("clear")},events:{tapped:()=>{},touchesBegan:t=>{e.disabled||(t.bgcolor=this.actionButtonHighlight)},touchesEnded:r,touchesCancelled:r,touchesMoved:(t,r,a)=>{e.disabled||(i(r)?t.bgcolor=this.actionButtonHighlight:t.bgcolor=$color("clear"))}},layout:(e,t)=>{2===this.actions.length?t.prev?(e.left.equalTo(t.prev.right).offset(-this.actionButtonBoderWidth),e.width.equalTo(t.super).dividedBy(2).offset(this.actionButtonBoderWidth)):e.width.equalTo(t.super).dividedBy(2):(e.width.equalTo(t.super),t.prev&&e.top.equalTo(t.prev.bottom).offset(-this.actionButtonBoderWidth)),e.height.equalTo(this.actionButtonHeight)}}};return{type:"view",views:this.actions.map(((t,i)=>e(t,i))),layout:(e,t)=>{e.left.equalTo(t.super).offset(-this.actionButtonBoderWidth),e.width.equalTo(t.super).offset(2*this.actionButtonBoderWidth),e.bottom.equalTo(t.super),e.top.equalTo(t.prev.bottom)}}}getView(){const e={type:"view",props:{id:this.id+"-box",smoothCorners:!0,cornerRadius:20,bgcolor:$color("#FFFFFF","#000000")},views:[this.textView(),this.actionView()],layout:(e,t)=>{e.center.equalTo(t.super.safeArea);let i=this.titleSize.height+this.messageSize.height+2*this.textVerticalMargin,r=this.actions.length>2?this.actions.length:1;i+=this.actionButtonHeight*r,i-=this.actionButtonBoderWidth*r;let a=this.boxWidth-2*this.actionButtonBoderWidth;e.size.equalTo($size(a,i))}};return{type:"view",props:{id:this.id,alpha:0,bgcolor:$rgba(0,0,0,.6)},views:[e],layout:$layout.fill}}present(){const e=$ui.create(this.getView());$ui.controller.view.hidden?$ui.controller.view.super.insertAtIndex(e,0):$ui.controller.view.insertAtIndex(e,0);const t=$(this.id);t.layout($layout.fill),t.moveToFront(),$ui.animate({duration:.3,animation:()=>{t.alpha=1}})}dismiss(){const e=$(this.id);$ui.animate({duration:.3,animation:()=>{e.alpha=0},completion:()=>{e.remove()}})}static fromJsbox(e){return new Promise(((t,i)=>{new $0c5cba21965f6942$var$Alert({title:e.title,message:e.message,actions:e?.actions?.map((e=>(e.handler||(e.handler=e=>{t(e)}),new $0c5cba21965f6942$var$AlertAction(e))))}).present()}))}}$0c5cba21965f6942$exports={Alert:$0c5cba21965f6942$var$Alert,AlertAction:$0c5cba21965f6942$var$AlertAction};var $cb554e51cde28d7a$require$Alert=$0c5cba21965f6942$exports.Alert,$cb554e51cde28d7a$require$AlertAction=$0c5cba21965f6942$exports.AlertAction,$fYz8N=parcelRequire("fYz8N"),$cb554e51cde28d7a$require$Controller=$fYz8N.Controller,$272f042430a952c6$exports={},$45Ip7=parcelRequire("45Ip7"),$272f042430a952c6$require$UIKit=$45Ip7.UIKit,$aXWmO=parcelRequire("aXWmO"),$272f042430a952c6$require$Sheet=$aXWmO.Sheet,$cgaQ6=parcelRequire("cgaQ6"),$272f042430a952c6$require$Kernel=$cgaQ6.Kernel,$12xzj=parcelRequire("12xzj"),$272f042430a952c6$require$NavigationView=$12xzj.NavigationView,$dcStC=parcelRequire("dcStC"),$272f042430a952c6$require$NavigationBar=$dcStC.NavigationBar;class $272f042430a952c6$var$FileManager{viewController;constructor(){this.listId="file-manager-list",this.edges=10,this.iconSize=25,this.loadL10n()}loadL10n(){$272f042430a952c6$require$Kernel.l10n("zh-Hans",{FILE_MANAGER_DELETE_CONFIRM_MSG:"确认要删除吗",DELETE:"删除",CANCEL:"取消",CLOSE:"关闭",SHARE:"分享",SAVE:"保存",SAVE_SUCCESS:"保存成功"},!1),$272f042430a952c6$require$Kernel.l10n("en",{FILE_MANAGER_DELETE_CONFIRM_MSG:"Are you sure you want to delete",DELETE:"Delete",CANCEL:"Cancel",CLOSE:"Close",SHARE:"Share",SAVE:"Save",SAVE_SUCCESS:"Save Success"},!1)}setViewController(e){this.viewController=e}get menu(){return{items:[{title:$l10n("SHARE"),symbol:"square.and.arrow.up",handler:async(e,t)=>{const i=e.object(t).info.info;$share.sheet([$file.absolutePath(i.path)])}}]}}delete(e){$file.delete(e.path)}edit(e){const t=$file.read(e.path);if(t.info?.mimeType?.startsWith("image"))$272f042430a952c6$require$Kernel.quickLookImage(t,e.path.substring(e.path.lastIndexOf("/")+1));else{const i=new $272f042430a952c6$require$Sheet,r=$text.uuid;i.setView({type:"code",layout:$layout.fill,props:{id:r,lineNumbers:!0,theme:$device.isDarkMode?"atom-one-dark":"atom-one-light",text:t.string,insets:$insets(15,15,15,15)}}).addNavBar({title:e.file,popButton:{title:$l10n("CLOSE")},rightButtons:[{title:$l10n("SAVE"),tapped:()=>{$file.write({data:$data({string:$(r).text}),path:e.path}),$ui.success($l10n("SAVE_SUCCESS"))}}]}),i.init().present()}}getFiles(e=""){return $file.list(e).map((t=>{const i=e+"/"+t,r=$file.isDirectory(i);return{info:{info:{path:i,file:t,isDirectory:r}},icon:{symbol:r?"folder.fill":"doc"},name:{text:t},size:{text:r?"":"--"}}})).sort(((e,t)=>e.info.info.isDirectory!==t.info.info.isDirectory?e.info.info.isDirectory?-1:1:e.info.info.isDirectory===t.info.info.isDirectory?e.info.info.file.localeCompare(t.info.info.file):void 0))}async loadFileSize(e){return e.map(((t,i)=>{const r=t.info.info;if(!r.isDirectory)try{e[i].size.text=$272f042430a952c6$require$Kernel.bytesToSize($file.read(r.path).info.size)}catch(t){e[i].size.text=t}})),e}get listTemplate(){return{props:{bgcolor:$color("clear")},views:[{props:{id:"info"}},{type:"image",props:{id:"icon"},layout:(e,t)=>{e.centerY.equalTo(t.super),e.left.inset(this.edges),e.size.equalTo(this.iconSize)}},{type:"view",views:[{type:"label",props:{id:"size",color:$color("secondaryText"),lines:1},layout:(e,t)=>{e.height.equalTo(t.super),e.right.inset(this.edges)}},{type:"label",props:{id:"name",lines:1},layout:(e,t)=>{e.height.left.equalTo(t.super),e.right.equalTo(t.prev.left).offset(-this.edges)}}],layout:(e,t)=>{e.height.right.equalTo(t.super),e.left.equalTo(t.prev.right).offset(this.edges)}}]}}#C(e,t){if(this.viewController){const i=new $272f042430a952c6$require$NavigationView;i.setView(t).navigationBarTitle(e),i.navigationBar.setLargeTitleDisplayMode($272f042430a952c6$require$NavigationBar.largeTitleDisplayModeNever),this.viewController.push(i)}else $272f042430a952c6$require$UIKit.push({title:e,views:[t]})}getListView(e=""){return{type:"list",props:{id:this.listId,menu:this.menu,info:{basePath:e},bgcolor:$272f042430a952c6$require$UIKit.primaryViewBackgroundColor,separatorInset:$insets(0,this.edges,0,0),data:[],template:this.listTemplate,actions:[{title:" "+$l10n("DELETE")+" ",color:$color("red"),handler:(e,t)=>{const i=e.object(t).info.info;$272f042430a952c6$require$Kernel.deleteConfirm($l10n("FILE_MANAGER_DELETE_CONFIRM_MSG")+' "'+i.file+'" ?',(()=>{this.delete(i),e.delete(t)}))}}]},layout:$layout.fill,events:{ready:()=>{const t=this.getFiles(e);$(this.listId).data=t,this.loadFileSize(t).then((e=>{$(this.listId).data=e}))},pulled:async e=>{const t=this.getFiles($(this.listId).info.basePath);$(this.listId).data=t,$(this.listId).data=await this.loadFileSize(t),$delay(.5,(()=>{e.endRefreshing()}))},didSelect:(e,t,i)=>{const r=i.info.info;r.isDirectory?this.#C(r.file,this.getListView(r.path)):this.edit(r)}}}}push(e=""){const t=e.substring(e.lastIndexOf("/"));this.#C(t,this.getListView(e))}}$272f042430a952c6$exports={FileManager:$272f042430a952c6$var$FileManager};var $cb554e51cde28d7a$require$FileManager=$272f042430a952c6$exports.FileManager,$8aDdQ=parcelRequire("8aDdQ"),$cb554e51cde28d7a$require$FileStorageParameterError=$8aDdQ.FileStorageParameterError,$cb554e51cde28d7a$require$FileStorageFileNotFoundError=$8aDdQ.FileStorageFileNotFoundError,$cb554e51cde28d7a$require$FileStorage=$8aDdQ.FileStorage,$4c192cc93140b629$exports={},$liCrE=parcelRequire("liCrE"),$4c192cc93140b629$require$View=$liCrE.View,$45Ip7=parcelRequire("45Ip7"),$4c192cc93140b629$require$UIKit=$45Ip7.UIKit;class $4c192cc93140b629$var$FixedFooterView extends $4c192cc93140b629$require$View{height=60;getView(){return this.type="view",this.setProp("bgcolor",$4c192cc93140b629$require$UIKit.primaryViewBackgroundColor),this.layout=(e,t)=>{e.left.right.bottom.equalTo(t.super),e.top.equalTo(t.super.safeAreaBottom).offset(-this.height)},this.views=[$4c192cc93140b629$require$View.create({props:this.props,views:this.views,layout:(e,t)=>{e.left.right.top.equalTo(t.super),e.height.equalTo(this.height)}})],this}}$4c192cc93140b629$exports={FixedFooterView:$4c192cc93140b629$var$FixedFooterView};var $cb554e51cde28d7a$require$FixedFooterView=$4c192cc93140b629$exports.FixedFooterView,$cgaQ6=parcelRequire("cgaQ6"),$cb554e51cde28d7a$require$Kernel=$cgaQ6.Kernel,$685246c8472a6c14$exports={},$8aDdQ=parcelRequire("8aDdQ"),$685246c8472a6c14$require$FileStorage=$8aDdQ.FileStorage;class $685246c8472a6c14$var$Logger{print;constructor(e){this.print=e??console.log}printToFile(e,t){this.print=i=>{if(e.exists(t)){i=(e.readSync(t)?.string??"")+i}e.writeSync(t,$data({string:i}))}}format(e,t){return`${(new Date).toUTCString()} [${t}] ${e}\n`}log(e,t){this.print(this.format(e,t))}info(e){this.log(e,"INFO")}error(e){this.log(e,"ERROR")}alert(e){this.log(e,"ALERT")}}$685246c8472a6c14$exports={Logger:$685246c8472a6c14$var$Logger};var $cb554e51cde28d7a$require$Logger=$685246c8472a6c14$exports.Logger,$50aa538fe0dbd3b0$exports={},$liCrE=parcelRequire("liCrE"),$50aa538fe0dbd3b0$require$View=$liCrE.View;class $50aa538fe0dbd3b0$var$Matrix extends $50aa538fe0dbd3b0$require$View{titleStyle={font:$font("bold",21),height:30};#x;#V;templateIdByIndex(e){return void 0===this.props.template.views[e]?.props?.id&&(void 0===this.props.template.views[e].props&&(this.props.template.views[e].props={}),this.props.template.views[e].props.id=$text.uuid),this.props.template.views[e].props.id}get templateHiddenStatus(){if(!this.#V){this.#V={};for(let e=0;e<this.props.template.views.length;e++)void 0===this.props.template.views[e].props.id&&void 0===this.props.template.views[e].props.hidden&&(this.#V[this.templateIdByIndex(e)]=!1),void 0!==this.props.template.views[e].props.hidden&&(this.#V[this.templateIdByIndex(e)]=this.props.template.views[e].props.hidden)}return this.#V}get hiddenViews(){if(!this.#x){this.#x={};for(let e=0;e<this.props.template.views.length;e++)this.#x[this.templateIdByIndex(e)]={hidden:!0}}return this.#x}get data(){const e=$(this.id).data,t=[];return e.map((e=>{e.items=e.items.filter((e=>!0===e?.__title?.hidden??!0)),t.push(e)})),t}set data(e){this.props.data=this.rebuildData(e),$(this.id).data=this.props.data}#E(e){let t={...this.hiddenViews};return Object.assign(t,{__templateProps:{hidden:!0},__title:{hidden:!1,text:e,info:{title:!0}}}),t}rebuildData(e=[]){return e.map((e=>(e.items=e.items.map((e=>(Object.keys(e).forEach((t=>{e[t].hidden=this.templateHiddenStatus[t]??!1})),Object.keys(this.templateHiddenStatus).forEach((t=>{e[t]||(e[t]={}),e[t].hidden=this.templateHiddenStatus[t]})),e.__templateProps={hidden:!1},e.__title={hidden:!0},e))),e.title&&e.items.unshift(this.#E(e.title)),e)))}rebuildTemplate(){let e={};void 0!==this.props.template.props&&(void 0!==this.props.template.props.cornerRadius&&(this.props.template.props.clipsToBounds=!1),e=Object.assign(this.props.template.props,{id:"__templateProps",hidden:!1}));const t=[{type:"view",props:e,layout:$layout.fill},{type:"label",props:{id:"__title",hidden:!0,font:this.titleStyle.font},layout:(e,t)=>{e.top.inset(-this.titleStyle.height/4*3),e.height.equalTo(this.titleStyle.height),e.width.equalTo(t.super.safeArea)}}].concat(this.props.template.views);this.props.template.views=t}insert(e,t=!0){return e.indexPath=this.indexPath(e.indexPath,t),$(this.id).insert(e)}delete(e,t=!0){return e=this.indexPath(e,t),$(this.id).delete(e)}object(e,t=!0){return e=this.indexPath(e,t),$(this.id).object(e)}cell(e,t=!0){return e=this.indexPath(e,t),$(this.id).cell(e)}indexPath(e,t){let i=t?1:0;return e="number"==typeof e?$indexPath(0,e+i):$indexPath(e.section,e.row+i)}getView(){return this.props.data=this.rebuildData(this.props.data),this.rebuildTemplate(),this.setEvent("itemSize",((e,t)=>{const i=e.object(t)?.__title?.info;if(i?.title)return $size(Math.max($device.info.screen.width,$device.info.screen.height),0);const r=this.props.columns??2,a=this.props.spacing??15,s=this.props.itemWidth??this.props.itemSize?.width??(e.super.frame.width-a*(r+1))/r,o=this.props.itemHeight??this.props.itemSize?.height??100;return $size(s,o)})),this}}$50aa538fe0dbd3b0$exports={Matrix:$50aa538fe0dbd3b0$var$Matrix};var $cb554e51cde28d7a$require$Matrix=$50aa538fe0dbd3b0$exports.Matrix,$619319e3f3656d3f$exports={};class $619319e3f3656d3f$var$RequestError extends Error{constructor({message:e,code:t,type:i}={}){super(e),this.name="RequestError",this.code=t,this.type=i}}class $619319e3f3656d3f$var$Request{static method={get:"GET",post:"POST",put:"PUT",delete:"DELETE",patch:"PATCH",head:"HEAD",options:"OPTIONS"};static errorType={http:0,network:1};cacheContainerKey=$addin?.current?.name+".request.cache";#A;#k=!1;#L=!1;cacheLife=2592e6;#N=!1;timeout=5;logger;constructor(e){"function"==typeof e&&(this.logger=e)}get cache(){return $cache.get(this.cacheContainerKey)??{}}#O(e){this.#N&&"function"==typeof this.logger&&this.logger(e)}logRequest(e){return this.#N=!0,"function"==typeof e&&(this.logger=e),this}disableLogRequest(){this.#N=!1}getCacheKey(e){return $text.MD5(e)}getCache(e,t=null){return this.cache[e]??t}setCache(e,t){if(!t)return;const i=this.cache;i[e]=t,$cache.set(this.cacheContainerKey,i)}removeCache(e){let t=this.cache;delete t[e],$cache.set(this.cacheContainerKey,t)}clearCache(){$cache.remove(this.cacheContainerKey)}clearNSURLCache(){this.#A||(this.#A=$objc("NSURLCache").$sharedURLCache()),this.#A.$removeAllCachedResponses()}enableCache(){return this.#k=!0,this}disableCache(){return this.#k=!1,this}ignoreCacheExp(){this.#L=!0}async request(e,t,i={},r={},a=this.cacheLife,s){let o;const n=this.#k&&t===$619319e3f3656d3f$var$Request.method.get;if(n){o=this.getCacheKey(e);const t=this.getCache(o);if(t&&(this.#L||t.exp>Date.now()))return this.#O("get data from cache: "+e),t.data}this.#O(`sending request [${t}]: ${e}`);const l=await $http.request(Object.assign({header:r,url:e,method:t,body:t===$619319e3f3656d3f$var$Request.method.get?null:i,timeout:this.timeout},s));if(l.error)throw new $619319e3f3656d3f$var$RequestError({type:$619319e3f3656d3f$var$Request.errorType.network,message:l.error.localizedDescription,code:l.error.code});if(l?.response?.statusCode>=400){let e=l.data;throw"object"==typeof e&&(e=JSON.stringify(e)),new $619319e3f3656d3f$var$RequestError({type:$619319e3f3656d3f$var$Request.errorType.http,message:e,code:l.response.statusCode})}return n&&this.setCache(o,{exp:Date.now()+a,data:l}),l}}$619319e3f3656d3f$exports={Request:$619319e3f3656d3f$var$Request};var $cb554e51cde28d7a$require$Request=$619319e3f3656d3f$exports.Request,$852e0adb411fa18d$exports={},$852e0adb411fa18d$require$Request=$619319e3f3656d3f$exports.Request;class $852e0adb411fa18d$var$WebDAV extends $852e0adb411fa18d$require$Request{#D;user;password;#R;namespace="JSBox.WebDAV";lockTokenCacheKey=this.namespace+".lockToken";get host(){return this.#D}set host(e){for(this.#D=e.trim();this.#D.endsWith("/");)this.#D=this.#D.substring(0,this.#D.length-1);this.#D.startsWith("http")||(this.#D="http://"+this.#D)}get basepath(){return this.#R}set basepath(e){for(this.#R=e.trim();this.#R.endsWith("/");)this.#R=this.#R.substring(0,this.#R.length-1);for(;this.#R.startsWith("/");)this.#R=this.#R.substring(1);this.#R="/"+this.#R}constructor({host:e,user:t,password:i,basepath:r=""}={}){super((e=>console.log(e))),this.host=e,this.user=t,this.password=i,this.basepath=r}#P(e){return e=(e=e.trim()).startsWith("/")?e:"/"+e,this.basepath+e}async request(e,t,i=null,r={}){return r=Object.assign({"Content-Type":"text/xml; charset=UTF-8",Authorization:"Basic "+$text.base64Encode(`${this.user}:${this.password}`)},r),await super.request(this.host+this.#P(e),t,i,r)}async allow(e){const t=await this.request(e,$852e0adb411fa18d$require$Request.method.options),i=t.response.headers?.allow??t.response.headers?.Allow;return i?.split(",").map((e=>e.trim().toUpperCase()))??[]}async propfind(e,t=[],i=0){Array.isArray(t)||(t=[t]);const r=`\n        <?xml version="1.0" encoding="utf-8" ?>\n        <D:propfind xmlns:D="DAV:">\n            <D:prop>${t.map((e=>`<D:${e}/>`)).join()}</D:prop>\n        </D:propfind>\n        `,a=await this.request(e,"PROPFIND",r,{Depth:i});return $xml.parse({string:a.data})}async propfindAll(e,t=0){const i=await this.request(e,"PROPFIND",'\n        <?xml version="1.0" encoding="utf-8" ?>\n        <D:propfind xmlns:D="DAV:">\n            <D:allprop/>\n        </D:propfind>\n        ',{Depth:t});return $xml.parse({string:i.data})}async ls(e,t=1){const i=await this.request(e,"PROPFIND",null,{Depth:t});return $xml.parse({string:i.data})}async exists(e){try{return(await this.allow(e)).includes($852e0adb411fa18d$require$Request.method.get)?await this.request(e,$852e0adb411fa18d$require$Request.method.head):await this.ls(e,0),!0}catch(e){if(404===e?.code)return!1;throw e}}async mkdir(e){return await this.request(e,"MKCOL")}async get(e){return await this.request(e,$852e0adb411fa18d$require$Request.method.get,null)}async put(e,t,{withLock:i=!0,waitInterval:r=2,maxTry:a=3}={}){let s={};for(;;){if(!await this.isLocked(e))break;if(--a<=0)throw new Error("Resource Locked");await $wait(r)}if(i)try{await this.lock(e),s.If=`(${this.#z(e)})`}catch(e){if(404!==e.code)throw e;i=!1}await this.request(e,$852e0adb411fa18d$require$Request.method.put,t,s),i&&await this.unlock(e)}async delete(e){if(!e)throw new Error("path empty");return await this.request(e,$852e0adb411fa18d$require$Request.method.delete)}#F(e,t){const i=$cache.get(this.lockTokenCacheKey)??{};i[e]=t,$cache.set(this.lockTokenCacheKey,i)}#z(e){return($cache.get(this.lockTokenCacheKey)??{})[e]}async isSupportLock(e){try{const t=await this.propfind(e,"supportedlock"),i=t.rootElement.firstChild({xPath:"//D:response/D:propstat/D:prop/D:supportedlock/D:lockentry"});return!!i.firstChild({xPath:"//D:locktype/D:write"})}catch(e){if(404!==e.code)return!1;throw e}}async lock(e,{infinity:t=!1,timeout:i="Second-10"}={}){if(!await this.isSupportLock(e))throw new Error("Your WebDAV service does not support the `LOCK` method.");const r=`\n        <?xml version="1.0" encoding="utf-8" ?>\n        <D:lockinfo xmlns:D='DAV:'>\n            <D:lockscope><D:exclusive/></D:lockscope>\n            <D:locktype><D:write/></D:locktype>\n            <D:owner>\n                <D:href>${this.namespace}</D:href>\n            </D:owner>\n        </D:lockinfo>\n        `,a=await this.request(e,"LOCK",r,{Timeout:i,Depth:t?"infinity":0}),s=a.response.headers["lock-token"]??a.response.headers["Lock-Token"];return this.#F(e,s),$xml.parse({string:a.data})}async isLocked(e){try{const t=(await this.propfind(e,"lockdiscovery")).rootElement,i=t.firstChild({xPath:"//D:response/D:propstat/D:status"}).string;if(!i.includes("404")){const i=t.firstChild({xPath:"//D:response/D:propstat/D:prop/D:lockdiscovery"}).children()??[];for(let t=0;t<i.length;t++){if(i[t].firstChild({tag:"lockroot"}).string===this.host+this.#P(e))return!0}}else await this.lock(e,{timeout:"Second-0"})}catch(e){if(423===e.code)return!0}return!1}async refreshLock(e,{infinity:t=!1,timeout:i="Second-10"}={}){const r=await this.request(e,"LOCK",null,{Timeout:i,If:this.#z(e),Depth:t?"infinity":0});return $xml.parse({string:r.data})}async unlock(e){await this.request(e,"UNLOCK",null,{"Lock-Token":this.#z(e)})}}$852e0adb411fa18d$exports={WebDAV:$852e0adb411fa18d$var$WebDAV};var $cb554e51cde28d7a$require$WebDAV=$852e0adb411fa18d$exports.WebDAV,$f799e4cd4156a938$exports={},$fYz8N=parcelRequire("fYz8N"),$f799e4cd4156a938$require$Controller=$fYz8N.Controller,$8aDdQ=parcelRequire("8aDdQ"),$f799e4cd4156a938$require$FileStorage=$8aDdQ.FileStorage,$cgaQ6=parcelRequire("cgaQ6"),$f799e4cd4156a938$require$Kernel=$cgaQ6.Kernel,$45Ip7=parcelRequire("45Ip7"),$f799e4cd4156a938$require$UIKit=$45Ip7.UIKit,$aXWmO=parcelRequire("aXWmO"),$f799e4cd4156a938$require$Sheet=$aXWmO.Sheet,$12xzj=parcelRequire("12xzj"),$f799e4cd4156a938$require$NavigationView=$12xzj.NavigationView,$c36a745eed97960f$exports={},$fYz8N=parcelRequire("fYz8N"),$c36a745eed97960f$require$Controller=$fYz8N.Controller;class $c36a745eed97960f$var$ViewController extends $c36a745eed97960f$require$Controller{#M=[];#H(e){e.callEvent("onPop"),this.callEvent("onPop",e),this.#M.pop()}push(e){const t=this.#M[this.#M.length-1];e.navigationBarItems.addPopButton(t?.navigationBar.title),this.#M.push(e),$ui.push({props:{statusBarStyle:0,navBarHidden:!0},events:{dealloc:()=>{this.#H(e)}},views:[e.getPage().definition],layout:$layout.fill})}}$c36a745eed97960f$exports={ViewController:$c36a745eed97960f$var$ViewController};var $f799e4cd4156a938$require$ViewController=$c36a745eed97960f$exports.ViewController,$22IPG=parcelRequire("22IPG"),$f799e4cd4156a938$require$SettingItem=$22IPG.SettingItem,$f799e4cd4156a938$require$SettingInfo=$22IPG.SettingInfo,$f799e4cd4156a938$require$SettingSwitch=$22IPG.SettingSwitch,$f799e4cd4156a938$require$SettingString=$22IPG.SettingString,$f799e4cd4156a938$require$SettingStepper=$22IPG.SettingStepper,$f799e4cd4156a938$require$SettingScript=$22IPG.SettingScript,$f799e4cd4156a938$require$SettingTab=$22IPG.SettingTab,$f799e4cd4156a938$require$SettingMenu=$22IPG.SettingMenu,$f799e4cd4156a938$require$SettingColor=$22IPG.SettingColor,$f799e4cd4156a938$require$SettingDate=$22IPG.SettingDate,$f799e4cd4156a938$require$SettingInput=$22IPG.SettingInput,$f799e4cd4156a938$require$SettingNumber=$22IPG.SettingNumber,$f799e4cd4156a938$require$SettingIcon=$22IPG.SettingIcon,$f799e4cd4156a938$require$SettingPush=$22IPG.SettingPush,$f799e4cd4156a938$require$SettingChild=$22IPG.SettingChild,$f799e4cd4156a938$require$SettingImage=$22IPG.SettingImage;class $f799e4cd4156a938$var$SettingLoadConfigError extends Error{constructor(){super("Call loadConfig() first."),this.name="SettingLoadConfigError"}}class $f799e4cd4156a938$var$SettingReadonlyError extends Error{constructor(){super("Attempted to assign to readonly property."),this.name="SettingReadonlyError"}}class $f799e4cd4156a938$var$Setting extends $f799e4cd4156a938$require$Controller{name;setting={};settingItems={};exclude=["script","info"];userData;fileStorage;imagePath;viewController=new $f799e4cd4156a938$require$ViewController;method={readme:()=>{const e=(()=>{const e=$device.info?.language?.startsWith("zh")?"README_CN.md":"README.md";try{return __README__[e]??__README__["README.md"]}catch{return $file.read(e)?.string??$file.read("README.md")?.string}})();(new $f799e4cd4156a938$require$Sheet).setView({type:"markdown",props:{content:e},layout:(e,t)=>{e.size.equalTo(t.super)}}).init().present()}};#U=!1;#K=!1;#j;constructor(e={}){super(),"function"==typeof e.set&&"function"==typeof e.get?(this.set=e.set,this.getOriginal=e.get,this.userData=e.userData??{}):(this.fileStorage=e.fileStorage??new $f799e4cd4156a938$require$FileStorage,this.dataFile=e.dataFile??"setting.json"),e.structure?this.setStructure(e.structure):this.setStructurePath(e.structurePath??"setting.json"),this.isUseJsboxNav=e.isUseJsboxNav??!1,this.imagePath=(e.name??"default")+".image/",this.setName(e.name??$text.uuid),this.loadL10n()}useJsboxNav(){return this.isUseJsboxNav=!0,this}#_(){if(!this.#K)throw new $f799e4cd4156a938$var$SettingLoadConfigError}loader(e){if(this.settingItems[e.key])return this.settingItems[e.key];Array.isArray(e.items)&&(e.items=e.items.map((e=>$l10n(e)))),e.title=$l10n(e.title),e.setting=this;let t=null;switch(e.type){case"info":t=$f799e4cd4156a938$require$SettingInfo.from(e).options(e.value);break;case"switch":t=$f799e4cd4156a938$require$SettingSwitch.from(e);break;case"string":t=$f799e4cd4156a938$require$SettingString.from(e);break;case"stepper":t=$f799e4cd4156a938$require$SettingStepper.from(e).options(e.min??1,e.max??12);break;case"script":t=$f799e4cd4156a938$require$SettingScript.from(e).options(e.value);break;case"tab":t=$f799e4cd4156a938$require$SettingTab.from(e).options(e.items,e.values);break;case"menu":t=$f799e4cd4156a938$require$SettingMenu.from(e).options(e.items,e.values,e.pullDown??!1);break;case"color":t=$f799e4cd4156a938$require$SettingColor.from(e);break;case"date":t=$f799e4cd4156a938$require$SettingDate.from(e).options(e.mode);break;case"input":t=$f799e4cd4156a938$require$SettingInput.from(e).options(e.secure);break;case"number":t=$f799e4cd4156a938$require$SettingNumber.from(e);break;case"icon":t=$f799e4cd4156a938$require$SettingIcon.from(e).options(e.bgcolor);break;case"push":t=$f799e4cd4156a938$require$SettingPush.from(e).options(e.view);break;case"child":t=$f799e4cd4156a938$require$SettingChild.from(e).options(e.children);break;case"image":t=$f799e4cd4156a938$require$SettingImage.from(e)}return t}loadConfig(){const e=this.userData??this.fileStorage.readAsJSON(this.dataFile,{}),t=i=>{for(let r of i)for(let i of r.items)"child"===i.type?t(i.children):this.exclude.includes(i.type)||(this.setting[i.key]=i.key in e?e[i.key]:i.value,this.settingItems[i.key]=this.loader(i))};return t(this.structure),this.#K=!0,this}hasSectionTitle(e){return this.#_(),!!e[0]?.title}loadL10n(){$f799e4cd4156a938$require$Kernel.l10n("zh-Hans",{OK:"好",DONE:"完成",CANCEL:"取消",CLEAR:"清除",BACK:"返回",ERROR:"发生错误",SUCCESS:"成功",INVALID_VALUE:"非法参数",CONFIRM_CHANGES:"数据已变化，确认修改？",SETTING:"设置",GENERAL:"一般",ADVANCED:"高级",TIPS:"小贴士",COLOR:"颜色",COPY:"复制",COPIED:"复制成功",JSBOX_ICON:"JSBox 内置图标",SF_SYMBOLS:"SF Symbols",IMAGE_BASE64:"图片 / base64",PREVIEW:"预览",SELECT_IMAGE_PHOTO:"从相册选择图片",SELECT_IMAGE_ICLOUD:"从 iCloud 选择图片",CLEAR_IMAGE:"清除图片",NO_IMAGE:"无图片",ABOUT:"关于",VERSION:"Version",AUTHOR:"作者",AT_BOTTOM:"已经到底啦~"},!1),$f799e4cd4156a938$require$Kernel.l10n("en",{OK:"OK",DONE:"Done",CANCEL:"Cancel",CLEAR:"Clear",BACK:"Back",ERROR:"Error",SUCCESS:"Success",INVALID_VALUE:"Invalid value",CONFIRM_CHANGES:"The data has changed, confirm the modification?",SETTING:"Setting",GENERAL:"General",ADVANCED:"Advanced",TIPS:"Tips",COLOR:"Color",COPY:"Copy",COPIED:"Copide",JSBOX_ICON:"JSBox in app icon",SF_SYMBOLS:"SF Symbols",IMAGE_BASE64:"Image / base64",PREVIEW:"Preview",SELECT_IMAGE_PHOTO:"Select From Photo",SELECT_IMAGE_ICLOUD:"Select From iCloud",CLEAR_IMAGE:"Clear Image",NO_IMAGE:"No Image",ABOUT:"About",VERSION:"Version",AUTHOR:"Author",AT_BOTTOM:"It's the end~"},!1)}setUserData(e){return this.userData=e,this}setStructure(e){return this.structure=e,this}setStructurePath(e){return this.structure||this.setStructure($f799e4cd4156a938$require$FileStorage.readFromRootAsJSON(e)),this}setName(e){return this.name=e,this}setFooter(e){return this.#j=e,this}set footer(e){this.#j=e}get footer(){if(void 0===this.#j){let e=$f799e4cd4156a938$require$FileStorage.readFromRootAsJSON("config.json",{}).info??{};if(!e.version||!e.author)try{e=__INFO__}catch{}this.#j={},e.version&&e.author&&(this.#j={type:"view",props:{height:70},views:[{type:"label",props:{font:$font(14),text:`${$l10n("VERSION")} ${e.version} ♥ ${e.author}`,textColor:$color({light:"#C0C0C0",dark:"#545454"}),align:$align.center},layout:e=>{e.left.right.inset(0),e.top.inset(10)}}]})}return this.#j}setReadonly(){return this.#U=!0,this}set(e,t){if(this.#U)throw new $f799e4cd4156a938$var$SettingReadonlyError;return this.#_(),this.setting[e]=t,this.fileStorage.write(this.dataFile,$data({string:JSON.stringify(this.setting)})),this.callEvent("onSet",e,t),!0}getOriginal(e,t=null){return this.#_(),Object.prototype.hasOwnProperty.call(this.setting,e)?this.setting[e]:t}get(e,t=null){return this.#_(),this.settingItems[e]?this.settingItems[e].get(t):this.getOriginal(e,t)}#G(e){const t=[];for(let i of e){const e=[];for(let t of i.items){let i=this.loader(t)?.create();i&&e.push(i)}t.push({title:$l10n(i.title??""),rows:e})}return t}getListView(e,t=this.footer){return{type:"list",props:{id:this.name,style:2,separatorInset:$insets(0,$f799e4cd4156a938$require$SettingItem.iconSize+2*$f799e4cd4156a938$require$SettingItem.edgeOffset,0,$f799e4cd4156a938$require$SettingItem.edgeOffset),bgcolor:$f799e4cd4156a938$require$UIKit.scrollViewBackgroundColor,footer:t,data:this.#G(e??this.structure)},layout:$layout.fill,events:{rowHeight:(e,t)=>(e.object(t)?.props?.info??{}).rowHeight??$f799e4cd4156a938$require$SettingItem.rowHeight}}}getNavigationView(){const e=new $f799e4cd4156a938$require$NavigationView;return e.setView(this.getListView(this.structure)).navigationBarTitle($l10n("SETTING")),this.hasSectionTitle(this.structure)&&e.navigationBar.setContentViewHeightOffset(-10),e}getPage(){return this.getNavigationView().getPage()}}$f799e4cd4156a938$exports={Setting:$f799e4cd4156a938$var$Setting};var $cb554e51cde28d7a$require$Setting=$f799e4cd4156a938$exports.Setting,$aXWmO=parcelRequire("aXWmO"),$cb554e51cde28d7a$require$Sheet=$aXWmO.Sheet,$7dfcabb1e936a92c$exports={},$liCrE=parcelRequire("liCrE"),$7dfcabb1e936a92c$require$View=$liCrE.View,$7dfcabb1e936a92c$require$PageView=$liCrE.PageView,$fYz8N=parcelRequire("fYz8N"),$7dfcabb1e936a92c$require$Controller=$fYz8N.Controller,$45Ip7=parcelRequire("45Ip7"),$7dfcabb1e936a92c$require$UIKit=$45Ip7.UIKit;class $7dfcabb1e936a92c$var$TabBarCellView extends $7dfcabb1e936a92c$require$View{constructor(e={}){super(e),this.setIcon(e.icon),this.setTitle(e.title),void 0!==e.activeStatus&&(this.activeStatus=e.activeStatus)}setIcon(e){return this.icon=e instanceof Array?e:[e,e],this}setTitle(e){return this.title=e,this}active(){$(`${this.props.id}-icon`).image=$image(this.icon[1]),$(`${this.props.id}-icon`).tintColor=$color("systemLink"),$(`${this.props.id}-title`).textColor=$color("systemLink"),this.activeStatus=!0}inactive(){$(`${this.props.id}-icon`).image=$image(this.icon[0]),$(`${this.props.id}-icon`).tintColor=$color("lightGray"),$(`${this.props.id}-title`).textColor=$color("lightGray"),this.activeStatus=!1}getView(){return this.views=[{type:"image",props:{id:`${this.props.id}-icon`,image:$image(this.activeStatus?this.icon[1]:this.icon[0]),bgcolor:$color("clear"),tintColor:$color(this.activeStatus?"systemLink":"lightGray")},layout:(e,t)=>{e.centerX.equalTo(t.super);const i=$7dfcabb1e936a92c$var$TabBarController.tabBarHeight/2;e.size.equalTo(i),e.top.inset(($7dfcabb1e936a92c$var$TabBarController.tabBarHeight-i-13)/2)}},{type:"label",props:{id:`${this.props.id}-title`,text:this.title,font:$font(10),textColor:$color(this.activeStatus?"systemLink":"lightGray")},layout:(e,t)=>{e.centerX.equalTo(t.prev),e.top.equalTo(t.prev.bottom).offset(3)}}],this}}class $7dfcabb1e936a92c$var$TabBarHeaderView extends $7dfcabb1e936a92c$require$View{height=60;getView(){return this.type="view",this.setProp("bgcolor",this.props.bgcolor??$7dfcabb1e936a92c$require$UIKit.primaryViewBackgroundColor),this.layout=(e,t)=>{e.left.right.bottom.equalTo(t.super),e.top.equalTo(t.super.safeAreaBottom).offset(-this.height-$7dfcabb1e936a92c$var$TabBarController.tabBarHeight)},this.views=[$7dfcabb1e936a92c$require$View.create({props:this.props,views:this.views,layout:(e,t)=>{e.left.right.top.equalTo(t.super),e.height.equalTo(this.height)}})],this}}class $7dfcabb1e936a92c$var$TabBarController extends $7dfcabb1e936a92c$require$Controller{static tabBarHeight=50;#W={};#Y={};#J;#Q;#X=$text.uuid;#Z=$text.uuid;bottomSafeAreaInsets=$app.isDebugging?0:$7dfcabb1e936a92c$require$UIKit.bottomSafeAreaInsets;get selected(){return this.#Q}set selected(e){this.switchPageTo(e)}get contentOffset(){return $7dfcabb1e936a92c$var$TabBarController.tabBarHeight+(this.#J?.height??0)}setPages(e={}){return Object.keys(e).forEach((t=>this.setPage(t,e[t]))),this}setPage(e,t){return void 0===this.#Q&&(this.#Q=e),this.#W[e]=t instanceof $7dfcabb1e936a92c$require$PageView?t:$7dfcabb1e936a92c$require$PageView.create(t),this.#Q!==e&&(this.#W[e].activeStatus=!1),this}switchPageTo(e){if(this.#W[e]){if(this.#Q===e)return;$ui.animate({duration:.4,animation:()=>{this.#Y[e].active()}}),this.#Y[this.#Q].inactive(),this.#W[this.#Q].hide(),this.#W[e].show(),this.callEvent("onChange",this.#Q,e),this.#Q=e,this.initBackground()}}hideBackground(e=!0){$(this.#Z).hidden=!0,$ui.animate({duration:e?.2:1e-4,animation:()=>{$(this.#X).alpha=0}})}showBackground(e=!0){$(this.#Z).hidden=!1,$ui.animate({duration:e?.2:1e-4,animation:()=>{$(this.#X).alpha=1}})}initBackground(){const e=this.#W[this.selected];e.scrollable&&$delay(0,(()=>{const t=$(e.id).get(e.scrollableView.id),i=t.contentOffset.y;t.contentSize.height+this.bottomSafeAreaInsets-t.frame.height-i<=0?this.hideBackground(!1):this.showBackground(!1)}))}setCells(e={}){return Object.keys(e).forEach((t=>this.setCell(t,e[t]))),this}setCell(e,t){return void 0===this.#Q&&(this.#Q=e),t instanceof $7dfcabb1e936a92c$var$TabBarCellView||(t=new $7dfcabb1e936a92c$var$TabBarCellView({props:{info:{key:e}},icon:t.icon,title:t.title,activeStatus:this.#Q===e})),this.#Y[e]=t,this}setHeader(e){return this.#J=e,this}#ee(){const e=[];return Object.values(this.#Y).forEach((t=>{t.setEvent("tapped",(e=>{const t=e.info.key;this.switchPageTo(t)})),e.push(t.getView())})),e}#te(){return Object.values(this.#W).map((e=>{if(e.scrollable){const t=e.scrollableView;if(t.props.indicatorInsets){const e=t.props.indicatorInsets;t.props.indicatorInsets=$insets(e.top,e.left,e.bottom+this.contentOffset,e.right)}else t.props.indicatorInsets=$insets(0,0,this.contentOffset,0);t.props.footer=Object.assign({props:{}},t.props.footer??{}),t.props.footer.props.height?t.props.footer.props.height+=this.contentOffset:t.props.footer.props.height=this.contentOffset,"function"==typeof t.assignEvent&&t.assignEvent("didScroll",(e=>{const t=e.contentOffset.y;e.contentSize.height+this.bottomSafeAreaInsets-e.frame.height-t<=1?this.hideBackground():this.showBackground()}))}return e.definition}))}generateView(){const e={type:"view",layout:(e,t)=>{e.centerX.equalTo(t.super),e.width.equalTo(t.super),e.top.equalTo(t.super.safeAreaBottom).offset(-$7dfcabb1e936a92c$var$TabBarController.tabBarHeight),e.bottom.equalTo(t.super)},views:[$7dfcabb1e936a92c$require$UIKit.blurBox({id:this.#X}),{type:"stack",layout:$layout.fillSafeArea,props:{axis:$stackViewAxis.horizontal,distribution:$stackViewDistribution.fillEqually,spacing:0,stack:{views:this.#ee()}}},$7dfcabb1e936a92c$require$UIKit.separatorLine({id:this.#Z},$7dfcabb1e936a92c$require$UIKit.align.top)],events:{ready:()=>this.initBackground()}};return $7dfcabb1e936a92c$require$View.createFromViews(this.#te().concat(this.#J?.definition??[],e))}}$7dfcabb1e936a92c$exports={TabBarCellView:$7dfcabb1e936a92c$var$TabBarCellView,TabBarHeaderView:$7dfcabb1e936a92c$var$TabBarHeaderView,TabBarController:$7dfcabb1e936a92c$var$TabBarController};var $cb554e51cde28d7a$require$TabBarCellView=$7dfcabb1e936a92c$exports.TabBarCellView,$cb554e51cde28d7a$require$TabBarHeaderView=$7dfcabb1e936a92c$exports.TabBarHeaderView,$cb554e51cde28d7a$require$TabBarController=$7dfcabb1e936a92c$exports.TabBarController,$3839e9f9bae78bdd$exports={};class $3839e9f9bae78bdd$var$Tasks{#ie={};addTask(e,t=0){const i=$text.uuid;return this.#ie[i]=$delay(t,(async()=>{await e(),delete this.#ie[i]})),i}cancelTask(e){this.#ie[e].cancel()}clearTasks(){Object.values(this.#ie).forEach((e=>e.cancel()))}}$3839e9f9bae78bdd$exports={Tasks:$3839e9f9bae78bdd$var$Tasks};var $cb554e51cde28d7a$require$Tasks=$3839e9f9bae78bdd$exports.Tasks,$895b2d75ea56b5f0$exports={},$45Ip7=parcelRequire("45Ip7"),$895b2d75ea56b5f0$require$UIKit=$45Ip7.UIKit;class $895b2d75ea56b5f0$var$Toast{static type={info:void 0,success:"checkmark",warning:"exclamationmark.triangle",error:"xmark.circle"};static edges=40;static iconSize=100;static labelTopMargin=10;static defaultFont=$font("default",26);width=Math.min(.6*$895b2d75ea56b5f0$require$UIKit.windowSize.width,260);labelWidth=this.width-2*$895b2d75ea56b5f0$var$Toast.edges;id=$text.uuid;#re="";font=$895b2d75ea56b5f0$var$Toast.defaultFont;type=$895b2d75ea56b5f0$var$Toast.type.info;labelLines=2;constructor(e,t=$895b2d75ea56b5f0$var$Toast.type.info,i=2,r=$895b2d75ea56b5f0$var$Toast.defaultFont){this.type=t,this.message=e,this.labelLines=i,this.font=r}get message(){return this.#re}set message(e){this.#re=e,this.fontHeight=$895b2d75ea56b5f0$require$UIKit.getContentSize(this.font,this.message,this.labelWidth,this.labelLines).height,this.height=(this.hasIcon?$895b2d75ea56b5f0$var$Toast.labelTopMargin+$895b2d75ea56b5f0$var$Toast.iconSize:0)+this.fontHeight+2*$895b2d75ea56b5f0$var$Toast.edges}get hasIcon(){return void 0!==this.type}get blurBox(){const e=$895b2d75ea56b5f0$require$UIKit.blurBox({id:this.id,cornerRadius:15,alpha:0},[{type:"image",props:{symbol:this.type,hidden:!this.hasIcon,tintColor:$color("lightGray")},layout:(e,t)=>{e.top.inset($895b2d75ea56b5f0$var$Toast.edges),e.size.equalTo($895b2d75ea56b5f0$var$Toast.iconSize),e.centerX.equalTo(t.super)}},{type:"label",props:{font:this.font,text:this.message,align:$align.center,lines:this.labelLines,color:$color("lightGray")},layout:(e,t)=>{e.bottom.equalTo(t.supper).offset(-$895b2d75ea56b5f0$var$Toast.edges),e.width.equalTo(this.labelWidth),e.height.equalTo(this.fontHeight),e.centerX.equalTo(t.super)}}]);return e.events={tapped:()=>{this.remove()}},e}show(){const e=$ui.create(this.blurBox);$ui.controller.view.hidden?$ui.controller.view.super.insertAtIndex(e,0):$ui.controller.view.insertAtIndex(e,0);const t=$(this.id);t.layout(((e,t)=>{e.center.equalTo(t.super),e.size.equalTo($size(this.width,this.height))})),t.moveToFront(),$ui.animate({duration:.2,animation:()=>{t.alpha=1}})}remove(){const e=$(this.id);e&&$ui.animate({duration:.2,animation:()=>{e.alpha=0},completion:()=>{e.remove()}})}static toast({message:e,type:t=$895b2d75ea56b5f0$var$Toast.type.info,show:i=!0,displayTime:r=2,labelLines:a=2,font:s=$895b2d75ea56b5f0$var$Toast.defaultFont}){const o=new $895b2d75ea56b5f0$var$Toast(e,t,a,s);return i&&(o.show(),$delay(r,(()=>{o.remove()}))),o}static info(e,t={}){return $895b2d75ea56b5f0$var$Toast.toast(Object.assign({message:e,type:$895b2d75ea56b5f0$var$Toast.type.info},t))}static success(e,t={}){return $895b2d75ea56b5f0$var$Toast.toast(Object.assign({message:e,type:$895b2d75ea56b5f0$var$Toast.type.success},t))}static warning(e,t={}){return $895b2d75ea56b5f0$var$Toast.toast(Object.assign({message:e,type:$895b2d75ea56b5f0$var$Toast.type.warning},t))}static error(e,t={}){return $895b2d75ea56b5f0$var$Toast.toast(Object.assign({message:e,type:$895b2d75ea56b5f0$var$Toast.type.error},t))}}$895b2d75ea56b5f0$exports={Toast:$895b2d75ea56b5f0$var$Toast};var $cb554e51cde28d7a$require$Toast=$895b2d75ea56b5f0$exports.Toast,$45Ip7=parcelRequire("45Ip7"),$cb554e51cde28d7a$require$UIKit=$45Ip7.UIKit,$86d2ffde19fb8791$exports={};class $86d2ffde19fb8791$var$UILoading{#ae;text="";interval;fullScreen=!1;#se=()=>{};constructor(){this.#ae=$text.uuid}updateText(e){$(this.#ae).text=e}setLoop(e){if("function"!=typeof e)throw"loop must be a function";this.#se=e}done(){clearInterval(this.interval)}load(){$ui.render({props:{navBarHidden:this.fullScreen},views:[{type:"spinner",props:{loading:!0},layout:(e,t)=>{e.centerY.equalTo(t.super).offset(-15),e.width.equalTo(t.super)}},{type:"label",props:{id:this.#ae,align:$align.center,text:""},layout:(e,t)=>{e.top.equalTo(t.prev.bottom).offset(10),e.left.right.equalTo(t.super)}}],layout:$layout.fill,events:{appeared:()=>{this.interval=setInterval((()=>{this.#se()}),100)}}})}}$86d2ffde19fb8791$exports={UILoading:$86d2ffde19fb8791$var$UILoading};var $cb554e51cde28d7a$require$UILoading=$86d2ffde19fb8791$exports.UILoading,$6Xrbz=parcelRequire("6Xrbz"),$cb554e51cde28d7a$require$ValidationError=$6Xrbz.ValidationError,$liCrE=parcelRequire("liCrE"),$cb554e51cde28d7a$require$View=$liCrE.View,$cb554e51cde28d7a$require$PageView=$liCrE.PageView,$cb554e51cde28d7a$require$ViewController=$c36a745eed97960f$exports.ViewController,$12xzj=parcelRequire("12xzj"),$cb554e51cde28d7a$require$NavigationView=$12xzj.NavigationView,$dcStC=parcelRequire("dcStC"),$cb554e51cde28d7a$require$NavigationBar=$dcStC.NavigationBar,$cb554e51cde28d7a$require$NavigationBarController=$dcStC.NavigationBarController,$gAYmG=parcelRequire("gAYmG"),$cb554e51cde28d7a$require$NavigationBarItems=$gAYmG.NavigationBarItems,$cb554e51cde28d7a$require$BarButtonItem=$gAYmG.BarButtonItem,$ee5e1f8d12d987dc$exports={},$45Ip7=parcelRequire("45Ip7"),$ee5e1f8d12d987dc$require$UIKit=$45Ip7.UIKit,$fYz8N=parcelRequire("fYz8N"),$ee5e1f8d12d987dc$require$Controller=$fYz8N.Controller,$gAYmG=parcelRequire("gAYmG"),$ee5e1f8d12d987dc$require$BarTitleView=$gAYmG.BarTitleView;class $ee5e1f8d12d987dc$var$SearchBar extends $ee5e1f8d12d987dc$require$BarTitleView{height=35;topOffset=15;bottomOffset=10;horizontalOffset=15;kbType=$kbType.search;placeholder=$l10n("SEARCH");inputEvents={};keyboardView;accessoryView;cancelButtonFont=$font(16);constructor(e){super(e),this.setController(new $ee5e1f8d12d987dc$var$SearchBarController),this.controller.setSearchBar(this)}get cancelButtonWidth(){return $ee5e1f8d12d987dc$require$UIKit.getContentSize(this.cancelButtonFont,$l10n("CANCEL")).width}setEvent(e,t){return this.inputEvents[e]=t,this}setPlaceholder(e){return this.placeholder=e,this}setKbType(e){return this.kbType=e,this}setKeyboardView(e){return this.keyboardView=e,this}setAccessoryView(e){return this.accessoryView=e,this}onBeginEditingAnimate(){$ui.animate({duration:.3,animation:()=>{const e=this.cancelButtonWidth;$(this.id+"-cancel-button").updateLayout(((t,i)=>{t.left.equalTo(i.super.right).offset(-e)})),$(this.id+"-cancel-button").alpha=1,$(this.id+"-cancel-button").relayout(),$(this.id+"-input").updateLayout((t=>{t.right.inset(e+this.horizontalOffset/2)})),$(this.id+"-input").relayout()}})}onEndEditingAnimate(){$ui.animate({duration:.3,animation:()=>{$(this.id+"-cancel-button").updateLayout(((e,t)=>{e.left.equalTo(t.super.right)})),$(this.id+"-cancel-button").alpha=0,$(this.id+"-cancel-button").relayout(),$(this.id+"-input").updateLayout($layout.fill),$(this.id+"-input").relayout()}})}cancel(){$(this.id+"-input").blur(),$(this.id+"-input").text="",this.onEndEditingAnimate(),this.controller.callEvent("onCancel")}getView(){return this.props={id:this.id,smoothCorners:!0,cornerRadius:6},this.views=[{type:"input",props:{id:this.id+"-input",type:this.kbType,bgcolor:$color("#EEF1F1","#212121"),placeholder:this.placeholder,keyboardView:this.keyboardView,accessoryView:this.accessoryView},layout:$layout.fill,events:Object.assign({didBeginEditing:e=>{this.onBeginEditingAnimate(),this.controller.callEvent("onBeginEditing",e.text)},didEndEditing:e=>{this.controller.callEvent("onEndEditing",e.text)},changed:e=>this.controller.callEvent("onChange",e.text),returned:e=>this.controller.callEvent("onReturn",e.text)},this.inputEvents)},{type:"button",props:{id:this.id+"-cancel-button",title:$l10n("CANCEL"),font:this.cancelButtonFont,titleColor:$color("tintColor"),bgcolor:$color("clear"),alpha:0,hidden:!1},events:{tapped:()=>this.cancel()},layout:(e,t)=>{e.height.equalTo(t.super),e.width.equalTo(this.cancelButtonWidth),e.left.equalTo(t.super.right)}}],this.layout=(e,t)=>{e.height.equalTo(this.height),e.top.equalTo(t.super.safeArea).offset(this.topOffset),e.left.equalTo(t.super.safeArea).offset(this.horizontalOffset),e.right.equalTo(t.super.safeArea).offset(-this.horizontalOffset)},this}}class $ee5e1f8d12d987dc$var$SearchBarController extends $ee5e1f8d12d987dc$require$Controller{setSearchBar(e){return this.searchBar=e,this}updateSelector(){this.selector={inputBox:$(this.searchBar.id),input:$(this.searchBar.id+"-input")}}hide(){this.updateSelector(),this.selector.inputBox.updateLayout((e=>{e.height.equalTo(0)}))}show(){this.updateSelector(),this.selector.inputBox.updateLayout((e=>{e.height.equalTo(this.searchBar.height)}))}didScroll(e){this.updateSelector();let t=this.searchBar.height-e;if(t=t>0?t>this.searchBar.height?this.searchBar.height:t:0,this.selector.inputBox.updateLayout((e=>{e.height.equalTo(t)})),e>0){const t=(this.searchBar.height/2-5-e)/10;this.selector.input.alpha=t}else this.selector.input.alpha=1}didEndDragging(e,t,i){this.updateSelector(),e>=0&&e<=this.searchBar.height&&i($point(0,e>=this.searchBar.height/2?this.searchBar.height:0))}}$ee5e1f8d12d987dc$exports={SearchBar:$ee5e1f8d12d987dc$var$SearchBar,SearchBarController:$ee5e1f8d12d987dc$var$SearchBarController};var $cb554e51cde28d7a$require$SearchBar=$ee5e1f8d12d987dc$exports.SearchBar,$cb554e51cde28d7a$require$SearchBarController=$ee5e1f8d12d987dc$exports.SearchBarController;module.exports={VERSION:$cb554e51cde28d7a$require$VERSION,Alert:$cb554e51cde28d7a$require$Alert,AlertAction:$cb554e51cde28d7a$require$AlertAction,Controller:$cb554e51cde28d7a$require$Controller,FileManager:$cb554e51cde28d7a$require$FileManager,FileStorageParameterError:$cb554e51cde28d7a$require$FileStorageParameterError,FileStorageFileNotFoundError:$cb554e51cde28d7a$require$FileStorageFileNotFoundError,FileStorage:$cb554e51cde28d7a$require$FileStorage,FixedFooterView:$cb554e51cde28d7a$require$FixedFooterView,Kernel:$cb554e51cde28d7a$require$Kernel,Logger:$cb554e51cde28d7a$require$Logger,Matrix:$cb554e51cde28d7a$require$Matrix,Request:$cb554e51cde28d7a$require$Request,WebDAV:$cb554e51cde28d7a$require$WebDAV,Setting:$cb554e51cde28d7a$require$Setting,Sheet:$cb554e51cde28d7a$require$Sheet,TabBarCellView:$cb554e51cde28d7a$require$TabBarCellView,TabBarHeaderView:$cb554e51cde28d7a$require$TabBarHeaderView,TabBarController:$cb554e51cde28d7a$require$TabBarController,Tasks:$cb554e51cde28d7a$require$Tasks,Toast:$cb554e51cde28d7a$require$Toast,UIKit:$cb554e51cde28d7a$require$UIKit,UILoading:$cb554e51cde28d7a$require$UILoading,ValidationError:$cb554e51cde28d7a$require$ValidationError,View:$cb554e51cde28d7a$require$View,PageView:$cb554e51cde28d7a$require$PageView,ViewController:$cb554e51cde28d7a$require$ViewController,NavigationView:$cb554e51cde28d7a$require$NavigationView,NavigationBar:$cb554e51cde28d7a$require$NavigationBar,NavigationBarController:$cb554e51cde28d7a$require$NavigationBarController,NavigationBarItems:$cb554e51cde28d7a$require$NavigationBarItems,BarButtonItem:$cb554e51cde28d7a$require$BarButtonItem,SearchBar:$cb554e51cde28d7a$require$SearchBar,SearchBarController:$cb554e51cde28d7a$require$SearchBarController};